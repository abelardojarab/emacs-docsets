
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Essential Basic Functionality &#8212; pandas 0.19.2 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.19.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="pandas 0.19.2 documentation" href="index.html" />
    <link rel="next" title="Working with Text Data" href="text.html" />
    <link rel="prev" title="Intro to Data Structures" href="dsintro.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="text.html" title="Working with Text Data"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="dsintro.html" title="Intro to Data Structures"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pandas 0.19.2 documentation</a> &#187;</li> 
      </ul>
    </div>
<div class="content-wrapper">
    <div class="content">
        <div class="document">
            <div class="sphinxsidebar">
                <h3>Table Of Contents</h3>
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="whatsnew.html">What&#8217;s New</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Package overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="10min.html">10 Minutes to pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="dsintro.html">Intro to Data Structures</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Essential Basic Functionality</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#head-and-tail">Head and Tail</a></li>
<li class="toctree-l2"><a class="reference internal" href="#attributes-and-the-raw-ndarray-s">Attributes and the raw ndarray(s)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accelerated-operations">Accelerated operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#flexible-binary-operations">Flexible binary operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#matching-broadcasting-behavior">Matching / broadcasting behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="#missing-data-operations-with-fill-values">Missing data / operations with fill values</a></li>
<li class="toctree-l3"><a class="reference internal" href="#flexible-comparisons">Flexible Comparisons</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boolean-reductions">Boolean Reductions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#comparing-if-objects-are-equivalent">Comparing if objects are equivalent</a></li>
<li class="toctree-l3"><a class="reference internal" href="#comparing-array-like-objects">Comparing array-like objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="#combining-overlapping-data-sets">Combining overlapping data sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#general-dataframe-combine">General DataFrame Combine</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#descriptive-statistics">Descriptive statistics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#summarizing-data-describe">Summarizing data: describe</a></li>
<li class="toctree-l3"><a class="reference internal" href="#index-of-min-max-values">Index of Min/Max Values</a></li>
<li class="toctree-l3"><a class="reference internal" href="#value-counts-histogramming-mode">Value counts (histogramming) / Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#discretization-and-quantiling">Discretization and quantiling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#function-application">Function application</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tablewise-function-application">Tablewise Function Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="#row-or-column-wise-function-application">Row or Column-wise Function Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="#applying-elementwise-python-functions">Applying elementwise Python functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#applying-with-a-panel">Applying with a Panel</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reindexing-and-altering-labels">Reindexing and altering labels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#reindexing-to-align-with-another-object">Reindexing to align with another object</a></li>
<li class="toctree-l3"><a class="reference internal" href="#aligning-objects-with-each-other-with-align">Aligning objects with each other with <code class="docutils literal"><span class="pre">align</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#filling-while-reindexing">Filling while reindexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#limits-on-filling-while-reindexing">Limits on filling while reindexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dropping-labels-from-an-axis">Dropping labels from an axis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#renaming-mapping-labels">Renaming / mapping labels</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#iteration">Iteration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#iteritems">iteritems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#iterrows">iterrows</a></li>
<li class="toctree-l3"><a class="reference internal" href="#itertuples">itertuples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dt-accessor">.dt accessor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vectorized-string-methods">Vectorized string methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sorting">Sorting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#by-index">By Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="#by-values">By Values</a></li>
<li class="toctree-l3"><a class="reference internal" href="#searchsorted">searchsorted</a></li>
<li class="toctree-l3"><a class="reference internal" href="#smallest-largest-values">smallest / largest values</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sorting-by-a-multi-index-column">Sorting by a multi-index column</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#copying">Copying</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dtypes">dtypes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#defaults">defaults</a></li>
<li class="toctree-l3"><a class="reference internal" href="#upcasting">upcasting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#astype">astype</a></li>
<li class="toctree-l3"><a class="reference internal" href="#object-conversion">object conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gotchas">gotchas</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#selecting-columns-based-on-dtype">Selecting columns based on <code class="docutils literal"><span class="pre">dtype</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="text.html">Working with Text Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="options.html">Options and Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="indexing.html">Indexing and Selecting Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">MultiIndex / Advanced Indexing</a></li>
<li class="toctree-l1"><a class="reference internal" href="computation.html">Computational tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="missing_data.html">Working with missing data</a></li>
<li class="toctree-l1"><a class="reference internal" href="groupby.html">Group By: split-apply-combine</a></li>
<li class="toctree-l1"><a class="reference internal" href="merging.html">Merge, join, and concatenate</a></li>
<li class="toctree-l1"><a class="reference internal" href="reshaping.html">Reshaping and Pivot Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="timeseries.html">Time Series / Date functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="timedeltas.html">Time Deltas</a></li>
<li class="toctree-l1"><a class="reference internal" href="categorical.html">Categorical Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="style.html">Style</a></li>
<li class="toctree-l1"><a class="reference internal" href="io.html">IO Tools (Text, CSV, HDF5, ...)</a></li>
<li class="toctree-l1"><a class="reference internal" href="remote_data.html">Remote Data Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="enhancingperf.html">Enhancing Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="sparse.html">Sparse data structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="gotchas.html">Caveats and Gotchas</a></li>
<li class="toctree-l1"><a class="reference internal" href="r_interface.html">rpy2 / R interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="ecosystem.html">pandas Ecosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparison_with_r.html">Comparison with R / R libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparison_with_sql.html">Comparison with SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparison_with_sas.html">Comparison with SAS</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals.html">Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="release.html">Release Notes</a></li>
</ul>

                <h3 style="margin-top: 1.5em;">Search</h3>

                <form class="search" action="search.html" method="get">
                    <input type="text" name="q" size="18"/>
                    <input type="submit" value="Go"/>
                    <input type="hidden" name="check_keywords" value="yes"/>
                    <input type="hidden" name="area" value="default"/>
                </form>
                <p class="searchtip" style="font-size: 90%">
                    Enter search terms or a module, class or function name.
                </p>

            </div>
             
            <div class="documentwrapper">
                <div class="bodywrapper">
                    <div class="body">
                        
  <div class="section" id="essential-basic-functionality">
<span id="basics"></span><h1>Essential Basic Functionality<a class="headerlink" href="#essential-basic-functionality" title="Permalink to this headline">¶</a></h1>
<p>Here we discuss a lot of the essential functionality common to the pandas data
structures. Here&#8217;s how to create some of the objects used in the examples from
the previous section:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;1/1/2000&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>

<span class="gp">In [3]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<span class="gp">   ...:</span>                   <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">   ...:</span> 

<span class="gp">In [4]: </span><span class="n">wp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">items</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Item1&#39;</span><span class="p">,</span> <span class="s1">&#39;Item2&#39;</span><span class="p">],</span>
<span class="gp">   ...:</span>               <span class="n">major_axis</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;1/1/2000&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
<span class="gp">   ...:</span>               <span class="n">minor_axis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">   ...:</span> 
</pre></div>
</div>
<div class="section" id="head-and-tail">
<span id="basics-head-tail"></span><h2>Head and Tail<a class="headerlink" href="#head-and-tail" title="Permalink to this headline">¶</a></h2>
<p>To view a small sample of a Series or DataFrame object, use the
<a class="reference internal" href="generated/pandas.DataFrame.head.html#pandas.DataFrame.head" title="pandas.DataFrame.head"><code class="xref py py-meth docutils literal"><span class="pre">head()</span></code></a> and <a class="reference internal" href="generated/pandas.DataFrame.tail.html#pandas.DataFrame.tail" title="pandas.DataFrame.tail"><code class="xref py py-meth docutils literal"><span class="pre">tail()</span></code></a> methods. The default number
of elements to display is five, but you may pass a custom number.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">long_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>

<span class="gp">In [6]: </span><span class="n">long_series</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gr">Out[6]: </span>
<span class="go">0   -0.305384</span>
<span class="go">1   -0.479195</span>
<span class="go">2    0.095031</span>
<span class="go">3   -0.270099</span>
<span class="go">4   -0.707140</span>
<span class="go">dtype: float64</span>

<span class="gp">In [7]: </span><span class="n">long_series</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gr">Out[7]: </span>
<span class="go">997    0.588446</span>
<span class="go">998    0.026465</span>
<span class="go">999   -1.728222</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</div>
<div class="section" id="attributes-and-the-raw-ndarray-s">
<span id="basics-attrs"></span><h2>Attributes and the raw ndarray(s)<a class="headerlink" href="#attributes-and-the-raw-ndarray-s" title="Permalink to this headline">¶</a></h2>
<p>pandas objects have a number of attributes enabling you to access the metadata</p>
<blockquote>
<div><ul class="simple">
<li><strong>shape</strong>: gives the axis dimensions of the object, consistent with ndarray</li>
<li>Axis labels<ul>
<li><strong>Series</strong>: <em>index</em> (only axis)</li>
<li><strong>DataFrame</strong>: <em>index</em> (rows) and <em>columns</em></li>
<li><strong>Panel</strong>: <em>items</em>, <em>major_axis</em>, and <em>minor_axis</em></li>
</ul>
</li>
</ul>
</div></blockquote>
<p>Note, <strong>these attributes can be safely assigned to</strong>!</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">df</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="gr">Out[8]: </span>
<span class="go">                   A         B         C</span>
<span class="go">2000-01-01  0.187483 -1.933946  0.377312</span>
<span class="go">2000-01-02  0.734122  2.141616 -0.011225</span>

<span class="gp">In [9]: </span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

<span class="gp">In [10]: </span><span class="n">df</span>
<span class="gr">Out[10]: </span>
<span class="go">                   a         b         c</span>
<span class="go">2000-01-01  0.187483 -1.933946  0.377312</span>
<span class="go">2000-01-02  0.734122  2.141616 -0.011225</span>
<span class="go">2000-01-03  0.048869 -1.360687 -0.479010</span>
<span class="go">2000-01-04 -0.859661 -0.231595 -0.527750</span>
<span class="go">2000-01-05 -1.296337  0.150680  0.123836</span>
<span class="go">2000-01-06  0.571764  1.555563 -0.823761</span>
<span class="go">2000-01-07  0.535420 -1.032853  1.469725</span>
<span class="go">2000-01-08  1.304124  1.449735  0.203109</span>
</pre></div>
</div>
<p>To get the actual data inside a data structure, one need only access the
<strong>values</strong> property:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">s</span><span class="o">.</span><span class="n">values</span>
<span class="gr">Out[11]: </span><span class="n">array</span><span class="p">([</span> <span class="mf">0.1122</span><span class="p">,</span>  <span class="mf">0.8717</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8161</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7849</span><span class="p">,</span>  <span class="mf">1.0307</span><span class="p">])</span>

<span class="gp">In [12]: </span><span class="n">df</span><span class="o">.</span><span class="n">values</span>
<span class="gr">Out[12]: </span>
<span class="go">array([[ 0.1875, -1.9339,  0.3773],</span>
<span class="go">       [ 0.7341,  2.1416, -0.0112],</span>
<span class="go">       [ 0.0489, -1.3607, -0.479 ],</span>
<span class="go">       [-0.8597, -0.2316, -0.5278],</span>
<span class="go">       [-1.2963,  0.1507,  0.1238],</span>
<span class="go">       [ 0.5718,  1.5556, -0.8238],</span>
<span class="go">       [ 0.5354, -1.0329,  1.4697],</span>
<span class="go">       [ 1.3041,  1.4497,  0.2031]])</span>

<span class="gp">In [13]: </span><span class="n">wp</span><span class="o">.</span><span class="n">values</span>
<span class="gr">Out[13]: </span>
<span class="go">array([[[-1.032 ,  0.9698, -0.9627,  1.3821],</span>
<span class="go">        [-0.9388,  0.6691, -0.4336, -0.2736],</span>
<span class="go">        [ 0.6804, -0.3084, -0.2761, -1.8212],</span>
<span class="go">        [-1.9936, -1.9274, -2.0279,  1.625 ],</span>
<span class="go">        [ 0.5511,  3.0593,  0.4553, -0.0307]],</span>

<span class="go">       [[ 0.9357,  1.0612, -2.1079,  0.1999],</span>
<span class="go">        [ 0.3236, -0.6416, -0.5875,  0.0539],</span>
<span class="go">        [ 0.1949, -0.382 ,  0.3186,  2.0891],</span>
<span class="go">        [-0.7283, -0.0903, -0.7482,  1.3189],</span>
<span class="go">        [-2.0298,  0.7927,  0.461 , -0.5427]]])</span>
</pre></div>
</div>
<p>If a DataFrame or Panel contains homogeneously-typed data, the ndarray can
actually be modified in-place, and the changes will be reflected in the data
structure. For heterogeneous data (e.g. some of the DataFrame&#8217;s columns are not
all the same dtype), this will not be the case. The values attribute itself,
unlike the axis labels, cannot be assigned to.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When working with heterogeneous data, the dtype of the resulting ndarray
will be chosen to accommodate all of the data involved. For example, if
strings are involved, the result will be of object dtype. If there are only
floats and integers, the resulting array will be of float dtype.</p>
</div>
</div>
<div class="section" id="accelerated-operations">
<span id="basics-accelerate"></span><h2>Accelerated operations<a class="headerlink" href="#accelerated-operations" title="Permalink to this headline">¶</a></h2>
<p>pandas has support for accelerating certain types of binary numerical and boolean operations using
the <code class="docutils literal"><span class="pre">numexpr</span></code> library (starting in 0.11.0) and the <code class="docutils literal"><span class="pre">bottleneck</span></code> libraries.</p>
<p>These libraries are especially useful when dealing with large data sets, and provide large
speedups. <code class="docutils literal"><span class="pre">numexpr</span></code> uses smart chunking, caching, and multiple cores. <code class="docutils literal"><span class="pre">bottleneck</span></code> is
a set of specialized cython routines that are especially fast when dealing with arrays that have
<code class="docutils literal"><span class="pre">nans</span></code>.</p>
<p>Here is a sample (using 100 column x 100,000 row <code class="docutils literal"><span class="pre">DataFrames</span></code>):</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operation</th>
<th class="head">0.11.0 (ms)</th>
<th class="head">Prior Version (ms)</th>
<th class="head">Ratio to Prior</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">df1</span> <span class="pre">&gt;</span> <span class="pre">df2</span></code></td>
<td>13.32</td>
<td>125.35</td>
<td>0.1063</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">df1</span> <span class="pre">*</span> <span class="pre">df2</span></code></td>
<td>21.71</td>
<td>36.63</td>
<td>0.5928</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">df1</span> <span class="pre">+</span> <span class="pre">df2</span></code></td>
<td>22.04</td>
<td>36.50</td>
<td>0.6039</td>
</tr>
</tbody>
</table>
<p>You are highly encouraged to install both libraries. See the section
<a class="reference internal" href="install.html#install-recommended-dependencies"><span class="std std-ref">Recommended Dependencies</span></a> for more installation info.</p>
</div>
<div class="section" id="flexible-binary-operations">
<span id="basics-binop"></span><h2>Flexible binary operations<a class="headerlink" href="#flexible-binary-operations" title="Permalink to this headline">¶</a></h2>
<p>With binary operations between pandas data structures, there are two key points
of interest:</p>
<blockquote>
<div><ul class="simple">
<li>Broadcasting behavior between higher- (e.g. DataFrame) and
lower-dimensional (e.g. Series) objects.</li>
<li>Missing data in computations</li>
</ul>
</div></blockquote>
<p>We will demonstrate how to manage these issues independently, though they can
be handled simultaneously.</p>
<div class="section" id="matching-broadcasting-behavior">
<h3>Matching / broadcasting behavior<a class="headerlink" href="#matching-broadcasting-behavior" title="Permalink to this headline">¶</a></h3>
<p>DataFrame has the methods <a class="reference internal" href="generated/pandas.DataFrame.add.html#pandas.DataFrame.add" title="pandas.DataFrame.add"><code class="xref py py-meth docutils literal"><span class="pre">add()</span></code></a>, <a class="reference internal" href="generated/pandas.DataFrame.sub.html#pandas.DataFrame.sub" title="pandas.DataFrame.sub"><code class="xref py py-meth docutils literal"><span class="pre">sub()</span></code></a>,
<a class="reference internal" href="generated/pandas.DataFrame.mul.html#pandas.DataFrame.mul" title="pandas.DataFrame.mul"><code class="xref py py-meth docutils literal"><span class="pre">mul()</span></code></a>, <a class="reference internal" href="generated/pandas.DataFrame.div.html#pandas.DataFrame.div" title="pandas.DataFrame.div"><code class="xref py py-meth docutils literal"><span class="pre">div()</span></code></a> and related functions
<a class="reference internal" href="generated/pandas.DataFrame.radd.html#pandas.DataFrame.radd" title="pandas.DataFrame.radd"><code class="xref py py-meth docutils literal"><span class="pre">radd()</span></code></a>, <a class="reference internal" href="generated/pandas.DataFrame.rsub.html#pandas.DataFrame.rsub" title="pandas.DataFrame.rsub"><code class="xref py py-meth docutils literal"><span class="pre">rsub()</span></code></a>, ...
for carrying out binary operations. For broadcasting behavior,
Series input is of primary interest. Using these functions, you can use to
either match on the <em>index</em> or <em>columns</em> via the <strong>axis</strong> keyword:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [14]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;one&#39;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]),</span>
<span class="gp">   ....:</span>                    <span class="s1">&#39;two&#39;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]),</span>
<span class="gp">   ....:</span>                    <span class="s1">&#39;three&#39;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])})</span>
<span class="gp">   ....:</span> 

<span class="gp">In [15]: </span><span class="n">df</span>
<span class="gr">Out[15]: </span>
<span class="go">        one     three       two</span>
<span class="go">a -0.626544       NaN -0.351587</span>
<span class="go">b -0.138894 -0.177289  1.136249</span>
<span class="go">c  0.011617  0.462215 -0.448789</span>
<span class="go">d       NaN  1.124472 -1.101558</span>

<span class="gp">In [16]: </span><span class="n">row</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="gp">In [17]: </span><span class="n">column</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;two&#39;</span><span class="p">]</span>

<span class="gp">In [18]: </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="gr">Out[18]: </span>
<span class="go">        one     three       two</span>
<span class="go">a -0.487650       NaN -1.487837</span>
<span class="go">b  0.000000  0.000000  0.000000</span>
<span class="go">c  0.150512  0.639504 -1.585038</span>
<span class="go">d       NaN  1.301762 -2.237808</span>

<span class="gp">In [19]: </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gr">Out[19]: </span>
<span class="go">        one     three       two</span>
<span class="go">a -0.487650       NaN -1.487837</span>
<span class="go">b  0.000000  0.000000  0.000000</span>
<span class="go">c  0.150512  0.639504 -1.585038</span>
<span class="go">d       NaN  1.301762 -2.237808</span>

<span class="gp">In [20]: </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="gr">Out[20]: </span>
<span class="go">        one     three  two</span>
<span class="go">a -0.274957       NaN  0.0</span>
<span class="go">b -1.275144 -1.313539  0.0</span>
<span class="go">c  0.460406  0.911003  0.0</span>
<span class="go">d       NaN  2.226031  0.0</span>

<span class="gp">In [21]: </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gr">Out[21]: </span>
<span class="go">        one     three  two</span>
<span class="go">a -0.274957       NaN  0.0</span>
<span class="go">b -1.275144 -1.313539  0.0</span>
<span class="go">c  0.460406  0.911003  0.0</span>
<span class="go">d       NaN  2.226031  0.0</span>
</pre></div>
</div>
<p>Furthermore you can align a level of a multi-indexed DataFrame with a Series.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [22]: </span><span class="n">dfmi</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="gp">In [23]: </span><span class="n">dfmi</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)],</span>
<span class="gp">   ....:</span>                                        <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">,</span><span class="s1">&#39;second&#39;</span><span class="p">])</span>
<span class="gp">   ....:</span> 

<span class="gp">In [24]: </span><span class="n">dfmi</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;second&#39;</span><span class="p">)</span>
<span class="gr">Out[24]: </span>
<span class="go">                   one     three       two</span>
<span class="go">first second                              </span>
<span class="go">1     a      -0.274957       NaN  0.000000</span>
<span class="go">      b      -1.275144 -1.313539  0.000000</span>
<span class="go">      c       0.460406  0.911003  0.000000</span>
<span class="go">2     a            NaN  1.476060 -0.749971</span>
</pre></div>
</div>
<p>With Panel, describing the matching behavior is a bit more difficult, so
the arithmetic methods instead (and perhaps confusingly?) give you the option
to specify the <em>broadcast axis</em>. For example, suppose we wished to demean the
data over a particular axis. This can be accomplished by taking the mean over
an axis and broadcasting over the same axis:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [25]: </span><span class="n">major_mean</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>

<span class="gp">In [26]: </span><span class="n">major_mean</span>
<span class="gr">Out[26]: </span>
<span class="go">      Item1     Item2</span>
<span class="go">A -0.546569 -0.260774</span>
<span class="go">B  0.492478  0.147993</span>
<span class="go">C -0.649010 -0.532794</span>
<span class="go">D  0.176307  0.623812</span>

<span class="gp">In [27]: </span><span class="n">wp</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">major_mean</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>
<span class="gr">Out[27]: </span>
<span class="go">&lt;class &#39;pandas.core.panel.Panel&#39;&gt;</span>
<span class="go">Dimensions: 2 (items) x 5 (major_axis) x 4 (minor_axis)</span>
<span class="go">Items axis: Item1 to Item2</span>
<span class="go">Major_axis axis: 2000-01-01 00:00:00 to 2000-01-05 00:00:00</span>
<span class="go">Minor_axis axis: A to D</span>
</pre></div>
</div>
<p>And similarly for <code class="docutils literal"><span class="pre">axis=&quot;items&quot;</span></code> and <code class="docutils literal"><span class="pre">axis=&quot;minor&quot;</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">I could be convinced to make the <strong>axis</strong> argument in the DataFrame methods
match the broadcasting behavior of Panel. Though it would require a
transition period so users can change their code...</p>
</div>
<p>Series and Index also support the <a class="reference external" href="https://docs.python.org/3/library/functions.html#divmod" title="(in Python v3.6)"><code class="xref py py-func docutils literal"><span class="pre">divmod()</span></code></a> builtin. This function takes
the floor division and modulo operation at the same time returning a two-tuple
of the same type as the left hand side. For example:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [28]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

<span class="gp">In [29]: </span><span class="n">s</span>
<span class="gr">Out[29]: </span>
<span class="go">0    0</span>
<span class="go">1    1</span>
<span class="go">2    2</span>
<span class="go">3    3</span>
<span class="go">4    4</span>
<span class="go">5    5</span>
<span class="go">6    6</span>
<span class="go">7    7</span>
<span class="go">8    8</span>
<span class="go">9    9</span>
<span class="go">dtype: int64</span>

<span class="gp">In [30]: </span><span class="n">div</span><span class="p">,</span> <span class="n">rem</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="gp">In [31]: </span><span class="n">div</span>
<span class="gr">Out[31]: </span>
<span class="go">0    0</span>
<span class="go">1    0</span>
<span class="go">2    0</span>
<span class="go">3    1</span>
<span class="go">4    1</span>
<span class="go">5    1</span>
<span class="go">6    2</span>
<span class="go">7    2</span>
<span class="go">8    2</span>
<span class="go">9    3</span>
<span class="go">dtype: int64</span>

<span class="gp">In [32]: </span><span class="n">rem</span>
<span class="gr">Out[32]: </span>
<span class="go">0    0</span>
<span class="go">1    1</span>
<span class="go">2    2</span>
<span class="go">3    0</span>
<span class="go">4    1</span>
<span class="go">5    2</span>
<span class="go">6    0</span>
<span class="go">7    1</span>
<span class="go">8    2</span>
<span class="go">9    0</span>
<span class="go">dtype: int64</span>

<span class="gp">In [33]: </span><span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

<span class="gp">In [34]: </span><span class="n">idx</span>
<span class="gr">Out[34]: </span><span class="n">Int64Index</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>

<span class="gp">In [35]: </span><span class="n">div</span><span class="p">,</span> <span class="n">rem</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="gp">In [36]: </span><span class="n">div</span>
<span class="gr">Out[36]: </span><span class="n">Int64Index</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>

<span class="gp">In [37]: </span><span class="n">rem</span>
<span class="gr">Out[37]: </span><span class="n">Int64Index</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We can also do elementwise <a class="reference external" href="https://docs.python.org/3/library/functions.html#divmod" title="(in Python v3.6)"><code class="xref py py-func docutils literal"><span class="pre">divmod()</span></code></a>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [38]: </span><span class="n">div</span><span class="p">,</span> <span class="n">rem</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="gp">In [39]: </span><span class="n">div</span>
<span class="gr">Out[39]: </span>
<span class="go">0    0</span>
<span class="go">1    0</span>
<span class="go">2    0</span>
<span class="go">3    1</span>
<span class="go">4    1</span>
<span class="go">5    1</span>
<span class="go">6    1</span>
<span class="go">7    1</span>
<span class="go">8    1</span>
<span class="go">9    1</span>
<span class="go">dtype: int64</span>

<span class="gp">In [40]: </span><span class="n">rem</span>
<span class="gr">Out[40]: </span>
<span class="go">0    0</span>
<span class="go">1    1</span>
<span class="go">2    2</span>
<span class="go">3    0</span>
<span class="go">4    0</span>
<span class="go">5    1</span>
<span class="go">6    1</span>
<span class="go">7    2</span>
<span class="go">8    2</span>
<span class="go">9    3</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
</div>
<div class="section" id="missing-data-operations-with-fill-values">
<h3>Missing data / operations with fill values<a class="headerlink" href="#missing-data-operations-with-fill-values" title="Permalink to this headline">¶</a></h3>
<p>In Series and DataFrame (though not yet in Panel), the arithmetic functions
have the option of inputting a <em>fill_value</em>, namely a value to substitute when
at most one of the values at a location are missing. For example, when adding
two DataFrame objects, you may wish to treat NaN as 0 unless both DataFrames
are missing that value, in which case the result will be NaN (you can later
replace NaN with some other value using <code class="docutils literal"><span class="pre">fillna</span></code> if you wish).</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [41]: </span><span class="n">df</span>
<span class="gr">Out[41]: </span>
<span class="go">        one     three       two</span>
<span class="go">a -0.626544       NaN -0.351587</span>
<span class="go">b -0.138894 -0.177289  1.136249</span>
<span class="go">c  0.011617  0.462215 -0.448789</span>
<span class="go">d       NaN  1.124472 -1.101558</span>

<span class="gp">In [42]: </span><span class="n">df2</span>
<span class="gr">Out[42]: </span>
<span class="go">        one     three       two</span>
<span class="go">a -0.626544  1.000000 -0.351587</span>
<span class="go">b -0.138894 -0.177289  1.136249</span>
<span class="go">c  0.011617  0.462215 -0.448789</span>
<span class="go">d       NaN  1.124472 -1.101558</span>

<span class="gp">In [43]: </span><span class="n">df</span> <span class="o">+</span> <span class="n">df2</span>
<span class="gr">Out[43]: </span>
<span class="go">        one     three       two</span>
<span class="go">a -1.253088       NaN -0.703174</span>
<span class="go">b -0.277789 -0.354579  2.272499</span>
<span class="go">c  0.023235  0.924429 -0.897577</span>
<span class="go">d       NaN  2.248945 -2.203116</span>

<span class="gp">In [44]: </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gr">Out[44]: </span>
<span class="go">        one     three       two</span>
<span class="go">a -1.253088  1.000000 -0.703174</span>
<span class="go">b -0.277789 -0.354579  2.272499</span>
<span class="go">c  0.023235  0.924429 -0.897577</span>
<span class="go">d       NaN  2.248945 -2.203116</span>
</pre></div>
</div>
</div>
<div class="section" id="flexible-comparisons">
<span id="basics-compare"></span><h3>Flexible Comparisons<a class="headerlink" href="#flexible-comparisons" title="Permalink to this headline">¶</a></h3>
<p>Starting in v0.8, pandas introduced binary comparison methods eq, ne, lt, gt,
le, and ge to Series and DataFrame whose behavior is analogous to the binary
arithmetic operations described above:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [45]: </span><span class="n">df</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="gr">Out[45]: </span>
<span class="go">     one  three    two</span>
<span class="go">a  False  False  False</span>
<span class="go">b  False  False  False</span>
<span class="go">c  False  False  False</span>
<span class="go">d  False  False  False</span>

<span class="gp">In [46]: </span><span class="n">df2</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="gr">Out[46]: </span>
<span class="go">     one  three    two</span>
<span class="go">a  False   True  False</span>
<span class="go">b  False  False  False</span>
<span class="go">c  False  False  False</span>
<span class="go">d   True  False  False</span>
</pre></div>
</div>
<p>These operations produce a pandas object the same type as the left-hand-side input
that if of dtype <code class="docutils literal"><span class="pre">bool</span></code>. These <code class="docutils literal"><span class="pre">boolean</span></code> objects can be used in indexing operations,
see <a class="reference internal" href="indexing.html#indexing-boolean"><span class="std std-ref">here</span></a></p>
</div>
<div class="section" id="boolean-reductions">
<span id="basics-reductions"></span><h3>Boolean Reductions<a class="headerlink" href="#boolean-reductions" title="Permalink to this headline">¶</a></h3>
<p>You can apply the reductions: <a class="reference internal" href="generated/pandas.DataFrame.empty.html#pandas.DataFrame.empty" title="pandas.DataFrame.empty"><code class="xref py py-attr docutils literal"><span class="pre">empty</span></code></a>, <a class="reference internal" href="generated/pandas.DataFrame.any.html#pandas.DataFrame.any" title="pandas.DataFrame.any"><code class="xref py py-meth docutils literal"><span class="pre">any()</span></code></a>,
<a class="reference internal" href="generated/pandas.DataFrame.all.html#pandas.DataFrame.all" title="pandas.DataFrame.all"><code class="xref py py-meth docutils literal"><span class="pre">all()</span></code></a>, and <a class="reference internal" href="generated/pandas.DataFrame.bool.html#pandas.DataFrame.bool" title="pandas.DataFrame.bool"><code class="xref py py-meth docutils literal"><span class="pre">bool()</span></code></a> to provide a
way to summarize a boolean result.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [47]: </span><span class="p">(</span><span class="n">df</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="gr">Out[47]: </span>
<span class="go">one      False</span>
<span class="go">three    False</span>
<span class="go">two      False</span>
<span class="go">dtype: bool</span>

<span class="gp">In [48]: </span><span class="p">(</span><span class="n">df</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="gr">Out[48]: </span>
<span class="go">one      True</span>
<span class="go">three    True</span>
<span class="go">two      True</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
<p>You can reduce to a final boolean value.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [49]: </span><span class="p">(</span><span class="n">df</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="gr">Out[49]: </span><span class="bp">True</span>
</pre></div>
</div>
<p>You can test if a pandas object is empty, via the <a class="reference internal" href="generated/pandas.DataFrame.empty.html#pandas.DataFrame.empty" title="pandas.DataFrame.empty"><code class="xref py py-attr docutils literal"><span class="pre">empty</span></code></a> property.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [50]: </span><span class="n">df</span><span class="o">.</span><span class="n">empty</span>
<span class="gr">Out[50]: </span><span class="bp">False</span>

<span class="gp">In [51]: </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABC&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">empty</span>
<span class="gr">Out[51]: </span><span class="bp">True</span>
</pre></div>
</div>
<p>To evaluate single-element pandas objects in a boolean context, use the method
<a class="reference internal" href="generated/pandas.DataFrame.bool.html#pandas.DataFrame.bool" title="pandas.DataFrame.bool"><code class="xref py py-meth docutils literal"><span class="pre">bool()</span></code></a>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [52]: </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="bp">True</span><span class="p">])</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span>
<span class="gr">Out[52]: </span><span class="bp">True</span>

<span class="gp">In [53]: </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="bp">False</span><span class="p">])</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span>
<span class="gr">Out[53]: </span><span class="bp">False</span>

<span class="gp">In [54]: </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="bp">True</span><span class="p">]])</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span>
<span class="gr">Out[54]: </span><span class="bp">True</span>

<span class="gp">In [55]: </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="bp">False</span><span class="p">]])</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span>
<span class="gr">Out[55]: </span><span class="bp">False</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>You might be tempted to do the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">df</span><span class="p">:</span>
<span class="go">     ...</span>
</pre></div>
</div>
<p>Or</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="ow">and</span> <span class="n">df2</span>
</pre></div>
</div>
<p>These both will raise as you are trying to compare multiple values.</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="ne">ValueError</span><span class="p">:</span> <span class="n">The</span> <span class="n">truth</span> <span class="n">value</span> <span class="n">of</span> <span class="n">an</span> <span class="n">array</span> <span class="ow">is</span> <span class="n">ambiguous</span><span class="o">.</span> <span class="n">Use</span> <span class="n">a</span><span class="o">.</span><span class="n">empty</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="ow">or</span> <span class="n">a</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span>
</pre></div>
</div>
</div>
<p>See <a class="reference internal" href="gotchas.html#gotchas-truth"><span class="std std-ref">gotchas</span></a> for a more detailed discussion.</p>
</div>
<div class="section" id="comparing-if-objects-are-equivalent">
<span id="basics-equals"></span><h3>Comparing if objects are equivalent<a class="headerlink" href="#comparing-if-objects-are-equivalent" title="Permalink to this headline">¶</a></h3>
<p>Often you may find there is more than one way to compute the same
result.  As a simple example, consider <code class="docutils literal"><span class="pre">df+df</span></code> and <code class="docutils literal"><span class="pre">df*2</span></code>. To test
that these two computations produce the same result, given the tools
shown above, you might imagine using <code class="docutils literal"><span class="pre">(df+df</span> <span class="pre">==</span> <span class="pre">df*2).all()</span></code>. But in
fact, this expression is False:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [56]: </span><span class="n">df</span><span class="o">+</span><span class="n">df</span> <span class="o">==</span> <span class="n">df</span><span class="o">*</span><span class="mi">2</span>
<span class="gr">Out[56]: </span>
<span class="go">     one  three   two</span>
<span class="go">a   True  False  True</span>
<span class="go">b   True   True  True</span>
<span class="go">c   True   True  True</span>
<span class="go">d  False   True  True</span>

<span class="gp">In [57]: </span><span class="p">(</span><span class="n">df</span><span class="o">+</span><span class="n">df</span> <span class="o">==</span> <span class="n">df</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="gr">Out[57]: </span>
<span class="go">one      False</span>
<span class="go">three    False</span>
<span class="go">two       True</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
<p>Notice that the boolean DataFrame <code class="docutils literal"><span class="pre">df+df</span> <span class="pre">==</span> <span class="pre">df*2</span></code> contains some False values!
That is because NaNs do not compare as equals:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [58]: </span><span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="gr">Out[58]: </span><span class="bp">False</span>
</pre></div>
</div>
<p>So, as of v0.13.1, NDFrames (such as Series, DataFrames, and Panels)
have an <a class="reference internal" href="generated/pandas.DataFrame.equals.html#pandas.DataFrame.equals" title="pandas.DataFrame.equals"><code class="xref py py-meth docutils literal"><span class="pre">equals()</span></code></a> method for testing equality, with NaNs in
corresponding locations treated as equal.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [59]: </span><span class="p">(</span><span class="n">df</span><span class="o">+</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="gr">Out[59]: </span><span class="bp">True</span>
</pre></div>
</div>
<p>Note that the Series or DataFrame index needs to be in the same order for
equality to be True:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [60]: </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;col&#39;</span><span class="p">:[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]})</span>

<span class="gp">In [61]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;col&#39;</span><span class="p">:[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>

<span class="gp">In [62]: </span><span class="n">df1</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="gr">Out[62]: </span><span class="bp">False</span>

<span class="gp">In [63]: </span><span class="n">df1</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">sort_index</span><span class="p">())</span>
<span class="gr">Out[63]: </span><span class="bp">True</span>
</pre></div>
</div>
</div>
<div class="section" id="comparing-array-like-objects">
<h3>Comparing array-like objects<a class="headerlink" href="#comparing-array-like-objects" title="Permalink to this headline">¶</a></h3>
<p>You can conveniently do element-wise comparisons when comparing a pandas
data structure with a scalar value:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [64]: </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;foo&#39;</span>
<span class="gr">Out[64]: </span>
<span class="go">0     True</span>
<span class="go">1    False</span>
<span class="go">2    False</span>
<span class="go">dtype: bool</span>

<span class="gp">In [65]: </span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;foo&#39;</span>
<span class="gr">Out[65]: </span><span class="n">array</span><span class="p">([</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</pre></div>
</div>
<p>Pandas also handles element-wise comparisons between different array-like
objects of the same length:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [66]: </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;qux&#39;</span><span class="p">])</span>
<span class="gr">Out[66]: </span>
<span class="go">0     True</span>
<span class="go">1     True</span>
<span class="go">2    False</span>
<span class="go">dtype: bool</span>

<span class="gp">In [67]: </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;qux&#39;</span><span class="p">])</span>
<span class="gr">Out[67]: </span>
<span class="go">0     True</span>
<span class="go">1     True</span>
<span class="go">2    False</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
<p>Trying to compare <code class="docutils literal"><span class="pre">Index</span></code> or <code class="docutils literal"><span class="pre">Series</span></code> objects of different lengths will
raise a ValueError:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [55]: </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">])</span>
<span class="go">ValueError: Series lengths must match to compare</span>

<span class="gp">In [56]: </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">])</span>
<span class="go">ValueError: Series lengths must match to compare</span>
</pre></div>
</div>
<p>Note that this is different from the numpy behavior where a comparison can
be broadcast:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [68]: </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">])</span>
<span class="gr">Out[68]: </span><span class="n">array</span><span class="p">([</span><span class="bp">False</span><span class="p">,</span>  <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</pre></div>
</div>
<p>or it can return False if broadcasting can not be done:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [69]: </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gr">Out[69]: </span><span class="bp">False</span>
</pre></div>
</div>
</div>
<div class="section" id="combining-overlapping-data-sets">
<h3>Combining overlapping data sets<a class="headerlink" href="#combining-overlapping-data-sets" title="Permalink to this headline">¶</a></h3>
<p>A problem occasionally arising is the combination of two similar data sets
where values in one are preferred over the other. An example would be two data
series representing a particular economic indicator where one is considered to
be of &#8220;higher quality&#8221;. However, the lower quality series might extend further
back in history or have more complete data coverage. As such, we would like to
combine two DataFrame objects where missing values in one DataFrame are
conditionally filled with like-labeled values from the other DataFrame. The
function implementing this operation is <a class="reference internal" href="generated/pandas.DataFrame.combine_first.html#pandas.DataFrame.combine_first" title="pandas.DataFrame.combine_first"><code class="xref py py-meth docutils literal"><span class="pre">combine_first()</span></code></a>,
which we illustrate:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [70]: </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="gp">   ....:</span>                     <span class="s1">&#39;B&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">6.</span><span class="p">]})</span>
<span class="gp">   ....:</span> 

<span class="gp">In [71]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">   ....:</span>                     <span class="s1">&#39;B&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">]})</span>
<span class="gp">   ....:</span> 

<span class="gp">In [72]: </span><span class="n">df1</span>
<span class="gr">Out[72]: </span>
<span class="go">     A    B</span>
<span class="go">0  1.0  NaN</span>
<span class="go">1  NaN  2.0</span>
<span class="go">2  3.0  3.0</span>
<span class="go">3  5.0  NaN</span>
<span class="go">4  NaN  6.0</span>

<span class="gp">In [73]: </span><span class="n">df2</span>
<span class="gr">Out[73]: </span>
<span class="go">     A    B</span>
<span class="go">0  5.0  NaN</span>
<span class="go">1  2.0  NaN</span>
<span class="go">2  4.0  3.0</span>
<span class="go">3  NaN  4.0</span>
<span class="go">4  3.0  6.0</span>
<span class="go">5  7.0  8.0</span>

<span class="gp">In [74]: </span><span class="n">df1</span><span class="o">.</span><span class="n">combine_first</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="gr">Out[74]: </span>
<span class="go">     A    B</span>
<span class="go">0  1.0  NaN</span>
<span class="go">1  2.0  2.0</span>
<span class="go">2  3.0  3.0</span>
<span class="go">3  5.0  4.0</span>
<span class="go">4  3.0  6.0</span>
<span class="go">5  7.0  8.0</span>
</pre></div>
</div>
</div>
<div class="section" id="general-dataframe-combine">
<h3>General DataFrame Combine<a class="headerlink" href="#general-dataframe-combine" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="generated/pandas.DataFrame.combine_first.html#pandas.DataFrame.combine_first" title="pandas.DataFrame.combine_first"><code class="xref py py-meth docutils literal"><span class="pre">combine_first()</span></code></a> method above calls the more general
DataFrame method <a class="reference internal" href="generated/pandas.DataFrame.combine.html#pandas.DataFrame.combine" title="pandas.DataFrame.combine"><code class="xref py py-meth docutils literal"><span class="pre">combine()</span></code></a>. This method takes another DataFrame
and a combiner function, aligns the input DataFrame and then passes the combiner
function pairs of Series (i.e., columns whose names are the same).</p>
<p>So, for instance, to reproduce <a class="reference internal" href="generated/pandas.DataFrame.combine_first.html#pandas.DataFrame.combine_first" title="pandas.DataFrame.combine_first"><code class="xref py py-meth docutils literal"><span class="pre">combine_first()</span></code></a> as above:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [75]: </span><span class="n">combiner</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="gp">In [76]: </span><span class="n">df1</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">combiner</span><span class="p">)</span>
<span class="gr">Out[76]: </span>
<span class="go">     A    B</span>
<span class="go">0  1.0  NaN</span>
<span class="go">1  2.0  2.0</span>
<span class="go">2  3.0  3.0</span>
<span class="go">3  5.0  4.0</span>
<span class="go">4  3.0  6.0</span>
<span class="go">5  7.0  8.0</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="descriptive-statistics">
<span id="basics-stats"></span><h2>Descriptive statistics<a class="headerlink" href="#descriptive-statistics" title="Permalink to this headline">¶</a></h2>
<p>A large number of methods for computing descriptive statistics and other related
operations on <a class="reference internal" href="api.html#api-series-stats"><span class="std std-ref">Series</span></a>, <a class="reference internal" href="api.html#api-dataframe-stats"><span class="std std-ref">DataFrame</span></a>, and <a class="reference internal" href="api.html#api-panel-stats"><span class="std std-ref">Panel</span></a>. Most of these
are aggregations (hence producing a lower-dimensional result) like
<a class="reference internal" href="generated/pandas.DataFrame.sum.html#pandas.DataFrame.sum" title="pandas.DataFrame.sum"><code class="xref py py-meth docutils literal"><span class="pre">sum()</span></code></a>, <a class="reference internal" href="generated/pandas.DataFrame.mean.html#pandas.DataFrame.mean" title="pandas.DataFrame.mean"><code class="xref py py-meth docutils literal"><span class="pre">mean()</span></code></a>, and <a class="reference internal" href="generated/pandas.DataFrame.quantile.html#pandas.DataFrame.quantile" title="pandas.DataFrame.quantile"><code class="xref py py-meth docutils literal"><span class="pre">quantile()</span></code></a>,
but some of them, like <a class="reference internal" href="generated/pandas.DataFrame.cumsum.html#pandas.DataFrame.cumsum" title="pandas.DataFrame.cumsum"><code class="xref py py-meth docutils literal"><span class="pre">cumsum()</span></code></a> and <a class="reference internal" href="generated/pandas.DataFrame.cumprod.html#pandas.DataFrame.cumprod" title="pandas.DataFrame.cumprod"><code class="xref py py-meth docutils literal"><span class="pre">cumprod()</span></code></a>,
produce an object of the same size. Generally speaking, these methods take an
<strong>axis</strong> argument, just like <em>ndarray.{sum, std, ...}</em>, but the axis can be
specified by name or integer:</p>
<blockquote>
<div><ul class="simple">
<li><strong>Series</strong>: no axis argument needed</li>
<li><strong>DataFrame</strong>: &#8220;index&#8221; (axis=0, default), &#8220;columns&#8221; (axis=1)</li>
<li><strong>Panel</strong>: &#8220;items&#8221; (axis=0), &#8220;major&#8221; (axis=1, default), &#8220;minor&#8221;
(axis=2)</li>
</ul>
</div></blockquote>
<p>For example:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [77]: </span><span class="n">df</span>
<span class="gr">Out[77]: </span>
<span class="go">        one     three       two</span>
<span class="go">a -0.626544       NaN -0.351587</span>
<span class="go">b -0.138894 -0.177289  1.136249</span>
<span class="go">c  0.011617  0.462215 -0.448789</span>
<span class="go">d       NaN  1.124472 -1.101558</span>

<span class="gp">In [78]: </span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gr">Out[78]: </span>
<span class="go">one     -0.251274</span>
<span class="go">three    0.469799</span>
<span class="go">two     -0.191421</span>
<span class="go">dtype: float64</span>

<span class="gp">In [79]: </span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gr">Out[79]: </span>
<span class="go">a   -0.489066</span>
<span class="go">b    0.273355</span>
<span class="go">c    0.008348</span>
<span class="go">d    0.011457</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<p>All such methods have a <code class="docutils literal"><span class="pre">skipna</span></code> option signaling whether to exclude missing
data (<code class="docutils literal"><span class="pre">True</span></code> by default):</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [80]: </span><span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gr">Out[80]: </span>
<span class="go">one           NaN</span>
<span class="go">three         NaN</span>
<span class="go">two     -0.765684</span>
<span class="go">dtype: float64</span>

<span class="gp">In [81]: </span><span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gr">Out[81]: </span>
<span class="go">a   -0.978131</span>
<span class="go">b    0.820066</span>
<span class="go">c    0.025044</span>
<span class="go">d    0.022914</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<p>Combined with the broadcasting / arithmetic behavior, one can describe various
statistical procedures, like standardization (rendering data zero mean and
standard deviation 1), very concisely:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [82]: </span><span class="n">ts_stand</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="gp">In [83]: </span><span class="n">ts_stand</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="gr">Out[83]: </span>
<span class="go">one      1.0</span>
<span class="go">three    1.0</span>
<span class="go">two      1.0</span>
<span class="go">dtype: float64</span>

<span class="gp">In [84]: </span><span class="n">xs_stand</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="gp">In [85]: </span><span class="n">xs_stand</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gr">Out[85]: </span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    1.0</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<p>Note that methods like <a class="reference internal" href="generated/pandas.DataFrame.cumsum.html#pandas.DataFrame.cumsum" title="pandas.DataFrame.cumsum"><code class="xref py py-meth docutils literal"><span class="pre">cumsum()</span></code></a> and <a class="reference internal" href="generated/pandas.DataFrame.cumprod.html#pandas.DataFrame.cumprod" title="pandas.DataFrame.cumprod"><code class="xref py py-meth docutils literal"><span class="pre">cumprod()</span></code></a>
preserve the location of NA values:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [86]: </span><span class="n">df</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="gr">Out[86]: </span>
<span class="go">        one     three       two</span>
<span class="go">a -0.626544       NaN -0.351587</span>
<span class="go">b -0.765438 -0.177289  0.784662</span>
<span class="go">c -0.753821  0.284925  0.335874</span>
<span class="go">d       NaN  1.409398 -0.765684</span>
</pre></div>
</div>
<p>Here is a quick reference summary table of common functions. Each also takes an
optional <code class="docutils literal"><span class="pre">level</span></code> parameter which applies only if the object has a
<a class="reference internal" href="advanced.html#advanced-hierarchical"><span class="std std-ref">hierarchical index</span></a>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Function</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">count</span></code></td>
<td>Number of non-null observations</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">sum</span></code></td>
<td>Sum of values</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">mean</span></code></td>
<td>Mean of values</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">mad</span></code></td>
<td>Mean absolute deviation</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">median</span></code></td>
<td>Arithmetic median of values</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">min</span></code></td>
<td>Minimum</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">max</span></code></td>
<td>Maximum</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">mode</span></code></td>
<td>Mode</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">abs</span></code></td>
<td>Absolute Value</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">prod</span></code></td>
<td>Product of values</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">std</span></code></td>
<td>Bessel-corrected sample standard deviation</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">var</span></code></td>
<td>Unbiased variance</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">sem</span></code></td>
<td>Standard error of the mean</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">skew</span></code></td>
<td>Sample skewness (3rd moment)</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">kurt</span></code></td>
<td>Sample kurtosis (4th moment)</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">quantile</span></code></td>
<td>Sample quantile (value at %)</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">cumsum</span></code></td>
<td>Cumulative sum</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">cumprod</span></code></td>
<td>Cumulative product</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">cummax</span></code></td>
<td>Cumulative maximum</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">cummin</span></code></td>
<td>Cumulative minimum</td>
</tr>
</tbody>
</table>
<p>Note that by chance some NumPy methods, like <code class="docutils literal"><span class="pre">mean</span></code>, <code class="docutils literal"><span class="pre">std</span></code>, and <code class="docutils literal"><span class="pre">sum</span></code>,
will exclude NAs on Series input by default:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [87]: </span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">])</span>
<span class="gr">Out[87]: </span><span class="o">-</span><span class="mf">0.2512736517583951</span>

<span class="gp">In [88]: </span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="gr">Out[88]: </span><span class="n">nan</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">Series</span></code> also has a method <a class="reference internal" href="generated/pandas.Series.nunique.html#pandas.Series.nunique" title="pandas.Series.nunique"><code class="xref py py-meth docutils literal"><span class="pre">nunique()</span></code></a> which will return the
number of unique non-null values:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [89]: </span><span class="n">series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">))</span>

<span class="gp">In [90]: </span><span class="n">series</span><span class="p">[</span><span class="mi">20</span><span class="p">:</span><span class="mi">500</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="gp">In [91]: </span><span class="n">series</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span>  <span class="o">=</span> <span class="mi">5</span>

<span class="gp">In [92]: </span><span class="n">series</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="gr">Out[92]: </span><span class="mi">11</span>
</pre></div>
</div>
<div class="section" id="summarizing-data-describe">
<span id="basics-describe"></span><h3>Summarizing data: describe<a class="headerlink" href="#summarizing-data-describe" title="Permalink to this headline">¶</a></h3>
<p>There is a convenient <a class="reference internal" href="generated/pandas.DataFrame.describe.html#pandas.DataFrame.describe" title="pandas.DataFrame.describe"><code class="xref py py-meth docutils literal"><span class="pre">describe()</span></code></a> function which computes a variety of summary
statistics about a Series or the columns of a DataFrame (excluding NAs of
course):</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [93]: </span><span class="n">series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>

<span class="gp">In [94]: </span><span class="n">series</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="gp">In [95]: </span><span class="n">series</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="gr">Out[95]: </span>
<span class="go">count    500.000000</span>
<span class="go">mean      -0.039663</span>
<span class="go">std        1.069371</span>
<span class="go">min       -3.463789</span>
<span class="go">25%       -0.731101</span>
<span class="go">50%       -0.058918</span>
<span class="go">75%        0.672758</span>
<span class="go">max        3.120271</span>
<span class="go">dtype: float64</span>

<span class="gp">In [96]: </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>

<span class="gp">In [97]: </span><span class="n">frame</span><span class="o">.</span><span class="n">ix</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="gp">In [98]: </span><span class="n">frame</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="gr">Out[98]: </span>
<span class="go">                a           b           c           d           e</span>
<span class="go">count  500.000000  500.000000  500.000000  500.000000  500.000000</span>
<span class="go">mean     0.000954   -0.044014    0.075936   -0.003679    0.020751</span>
<span class="go">std      1.005133    0.974882    0.967432    1.004732    0.963812</span>
<span class="go">min     -3.010899   -2.782760   -3.401252   -2.944925   -3.794127</span>
<span class="go">25%     -0.682900   -0.681161   -0.528190   -0.663503   -0.615717</span>
<span class="go">50%     -0.001651   -0.006279    0.040098   -0.003378    0.006282</span>
<span class="go">75%      0.656439    0.632852    0.717919    0.687214    0.653423</span>
<span class="go">max      3.007143    2.627688    2.702490    2.850852    3.072117</span>
</pre></div>
</div>
<p>You can select specific percentiles to include in the output:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [99]: </span><span class="n">series</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">percentiles</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mo">05</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">75</span><span class="p">,</span> <span class="o">.</span><span class="mi">95</span><span class="p">])</span>
<span class="gr">Out[99]: </span>
<span class="go">count    500.000000</span>
<span class="go">mean      -0.039663</span>
<span class="go">std        1.069371</span>
<span class="go">min       -3.463789</span>
<span class="go">5%        -1.741334</span>
<span class="go">25%       -0.731101</span>
<span class="go">50%       -0.058918</span>
<span class="go">75%        0.672758</span>
<span class="go">95%        1.854383</span>
<span class="go">max        3.120271</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<p>By default, the median is always included.</p>
<p>For a non-numerical Series object, <a class="reference internal" href="generated/pandas.Series.describe.html#pandas.Series.describe" title="pandas.Series.describe"><code class="xref py py-meth docutils literal"><span class="pre">describe()</span></code></a> will give a simple
summary of the number of unique values and most frequently occurring values:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [100]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>

<span class="gp">In [101]: </span><span class="n">s</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="gr">Out[101]: </span>
<span class="go">count     9</span>
<span class="go">unique    4</span>
<span class="go">top       a</span>
<span class="go">freq      5</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>Note that on a mixed-type DataFrame object, <a class="reference internal" href="generated/pandas.DataFrame.describe.html#pandas.DataFrame.describe" title="pandas.DataFrame.describe"><code class="xref py py-meth docutils literal"><span class="pre">describe()</span></code></a> will
restrict the summary to include only numerical columns or, if none are, only
categorical columns:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [102]: </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)})</span>

<span class="gp">In [103]: </span><span class="n">frame</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="gr">Out[103]: </span>
<span class="go">              b</span>
<span class="go">count  4.000000</span>
<span class="go">mean   1.500000</span>
<span class="go">std    1.290994</span>
<span class="go">min    0.000000</span>
<span class="go">25%    0.750000</span>
<span class="go">50%    1.500000</span>
<span class="go">75%    2.250000</span>
<span class="go">max    3.000000</span>
</pre></div>
</div>
<p>This behaviour can be controlled by providing a list of types as <code class="docutils literal"><span class="pre">include</span></code>/<code class="docutils literal"><span class="pre">exclude</span></code>
arguments. The special value <code class="docutils literal"><span class="pre">all</span></code> can also be used:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [104]: </span><span class="n">frame</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span>
<span class="gr">Out[104]: </span>
<span class="go">         a</span>
<span class="go">count    4</span>
<span class="go">unique   2</span>
<span class="go">top     No</span>
<span class="go">freq     2</span>

<span class="gp">In [105]: </span><span class="n">frame</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">])</span>
<span class="gr">Out[105]: </span>
<span class="go">              b</span>
<span class="go">count  4.000000</span>
<span class="go">mean   1.500000</span>
<span class="go">std    1.290994</span>
<span class="go">min    0.000000</span>
<span class="go">25%    0.750000</span>
<span class="go">50%    1.500000</span>
<span class="go">75%    2.250000</span>
<span class="go">max    3.000000</span>

<span class="gp">In [106]: </span><span class="n">frame</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="gr">Out[106]: </span>
<span class="go">          a         b</span>
<span class="go">count     4  4.000000</span>
<span class="go">unique    2       NaN</span>
<span class="go">top      No       NaN</span>
<span class="go">freq      2       NaN</span>
<span class="go">mean    NaN  1.500000</span>
<span class="go">std     NaN  1.290994</span>
<span class="go">min     NaN  0.000000</span>
<span class="go">25%     NaN  0.750000</span>
<span class="go">50%     NaN  1.500000</span>
<span class="go">75%     NaN  2.250000</span>
<span class="go">max     NaN  3.000000</span>
</pre></div>
</div>
<p>That feature relies on <a class="reference internal" href="#basics-selectdtypes"><span class="std std-ref">select_dtypes</span></a>. Refer to
there for details about accepted inputs.</p>
</div>
<div class="section" id="index-of-min-max-values">
<span id="basics-idxmin"></span><h3>Index of Min/Max Values<a class="headerlink" href="#index-of-min-max-values" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="generated/pandas.DataFrame.idxmin.html#pandas.DataFrame.idxmin" title="pandas.DataFrame.idxmin"><code class="xref py py-meth docutils literal"><span class="pre">idxmin()</span></code></a> and <a class="reference internal" href="generated/pandas.DataFrame.idxmax.html#pandas.DataFrame.idxmax" title="pandas.DataFrame.idxmax"><code class="xref py py-meth docutils literal"><span class="pre">idxmax()</span></code></a> functions on Series
and DataFrame compute the index labels with the minimum and maximum
corresponding values:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [107]: </span><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

<span class="gp">In [108]: </span><span class="n">s1</span>
<span class="gr">Out[108]: </span>
<span class="go">0   -0.872725</span>
<span class="go">1    1.522411</span>
<span class="go">2    0.080594</span>
<span class="go">3   -1.676067</span>
<span class="go">4    0.435804</span>
<span class="go">dtype: float64</span>

<span class="gp">In [109]: </span><span class="n">s1</span><span class="o">.</span><span class="n">idxmin</span><span class="p">(),</span> <span class="n">s1</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
<span class="gr">Out[109]: </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">In [110]: </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>

<span class="gp">In [111]: </span><span class="n">df1</span>
<span class="gr">Out[111]: </span>
<span class="go">          A         B         C</span>
<span class="go">0  0.445734 -1.649461  0.169660</span>
<span class="go">1  1.246181  0.131682 -2.001988</span>
<span class="go">2 -1.273023  0.870502  0.214583</span>
<span class="go">3  0.088452 -0.173364  1.207466</span>
<span class="go">4  0.546121  0.409515 -0.310515</span>

<span class="gp">In [112]: </span><span class="n">df1</span><span class="o">.</span><span class="n">idxmin</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gr">Out[112]: </span>
<span class="go">A    2</span>
<span class="go">B    0</span>
<span class="go">C    1</span>
<span class="go">dtype: int64</span>

<span class="gp">In [113]: </span><span class="n">df1</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gr">Out[113]: </span>
<span class="go">0    A</span>
<span class="go">1    A</span>
<span class="go">2    B</span>
<span class="go">3    C</span>
<span class="go">4    A</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>When there are multiple rows (or columns) matching the minimum or maximum
value, <a class="reference internal" href="generated/pandas.DataFrame.idxmin.html#pandas.DataFrame.idxmin" title="pandas.DataFrame.idxmin"><code class="xref py py-meth docutils literal"><span class="pre">idxmin()</span></code></a> and <a class="reference internal" href="generated/pandas.DataFrame.idxmax.html#pandas.DataFrame.idxmax" title="pandas.DataFrame.idxmax"><code class="xref py py-meth docutils literal"><span class="pre">idxmax()</span></code></a> return the first
matching index:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [114]: </span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;edcba&#39;</span><span class="p">))</span>

<span class="gp">In [115]: </span><span class="n">df3</span>
<span class="gr">Out[115]: </span>
<span class="go">     A</span>
<span class="go">e  2.0</span>
<span class="go">d  1.0</span>
<span class="go">c  1.0</span>
<span class="go">b  3.0</span>
<span class="go">a  NaN</span>

<span class="gp">In [116]: </span><span class="n">df3</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
<span class="gr">Out[116]: </span><span class="s1">&#39;d&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">idxmin</span></code> and <code class="docutils literal"><span class="pre">idxmax</span></code> are called <code class="docutils literal"><span class="pre">argmin</span></code> and <code class="docutils literal"><span class="pre">argmax</span></code> in NumPy.</p>
</div>
</div>
<div class="section" id="value-counts-histogramming-mode">
<span id="basics-discretization"></span><h3>Value counts (histogramming) / Mode<a class="headerlink" href="#value-counts-histogramming-mode" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="generated/pandas.Series.value_counts.html#pandas.Series.value_counts" title="pandas.Series.value_counts"><code class="xref py py-meth docutils literal"><span class="pre">value_counts()</span></code></a> Series method and top-level function computes a histogram
of a 1D array of values. It can also be used as a function on regular arrays:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [117]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="gp">In [118]: </span><span class="n">data</span>
<span class="gr">Out[118]: </span>
<span class="go">array([5, 3, 2, 2, 1, 4, 0, 4, 0, 2, 0, 6, 4, 1, 6, 3, 3, 0, 2, 1, 0, 5, 5,</span>
<span class="go">       3, 6, 1, 5, 6, 2, 0, 0, 6, 3, 3, 5, 0, 4, 3, 3, 3, 0, 6, 1, 3, 5, 5,</span>
<span class="go">       0, 4, 0, 6])</span>

<span class="gp">In [119]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="gp">In [120]: </span><span class="n">s</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="gr">Out[120]: </span>
<span class="go">0    11</span>
<span class="go">3    10</span>
<span class="go">6     7</span>
<span class="go">5     7</span>
<span class="go">4     5</span>
<span class="go">2     5</span>
<span class="go">1     5</span>
<span class="go">dtype: int64</span>

<span class="gp">In [121]: </span><span class="n">pd</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gr">Out[121]: </span>
<span class="go">0    11</span>
<span class="go">3    10</span>
<span class="go">6     7</span>
<span class="go">5     7</span>
<span class="go">4     5</span>
<span class="go">2     5</span>
<span class="go">1     5</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
<p>Similarly, you can get the most frequently occurring value(s) (the mode) of the values in a Series or DataFrame:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [122]: </span><span class="n">s5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="gp">In [123]: </span><span class="n">s5</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span>
<span class="gr">Out[123]: </span>
<span class="go">0    3</span>
<span class="go">1    7</span>
<span class="go">dtype: int64</span>

<span class="gp">In [124]: </span><span class="n">df5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">),</span>
<span class="gp">   .....:</span>                     <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)})</span>
<span class="gp">   .....:</span> 

<span class="gp">In [125]: </span><span class="n">df5</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span>
<span class="gr">Out[125]: </span>
<span class="go">   A  B</span>
<span class="go">0  1 -5</span>
</pre></div>
</div>
</div>
<div class="section" id="discretization-and-quantiling">
<h3>Discretization and quantiling<a class="headerlink" href="#discretization-and-quantiling" title="Permalink to this headline">¶</a></h3>
<p>Continuous values can be discretized using the <a class="reference internal" href="generated/pandas.cut.html#pandas.cut" title="pandas.cut"><code class="xref py py-func docutils literal"><span class="pre">cut()</span></code></a> (bins based on values)
and <a class="reference internal" href="generated/pandas.qcut.html#pandas.qcut" title="pandas.qcut"><code class="xref py py-func docutils literal"><span class="pre">qcut()</span></code></a> (bins based on sample quantiles) functions:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [126]: </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

<span class="gp">In [127]: </span><span class="n">factor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="gp">In [128]: </span><span class="n">factor</span>
<span class="gr">Out[128]: </span>
<span class="go">[(-0.645, 0.336], (-2.61, -1.626], (-1.626, -0.645], (-1.626, -0.645], (-1.626, -0.645], ..., (0.336, 1.316], (0.336, 1.316], (0.336, 1.316], (0.336, 1.316], (-2.61, -1.626]]</span>
<span class="go">Length: 20</span>
<span class="go">Categories (4, object): [(-2.61, -1.626] &lt; (-1.626, -0.645] &lt; (-0.645, 0.336] &lt; (0.336, 1.316]]</span>

<span class="gp">In [129]: </span><span class="n">factor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="gp">In [130]: </span><span class="n">factor</span>
<span class="gr">Out[130]: </span>
<span class="go">[(-1, 0], (-5, -1], (-1, 0], (-5, -1], (-1, 0], ..., (0, 1], (1, 5], (0, 1], (0, 1], (-5, -1]]</span>
<span class="go">Length: 20</span>
<span class="go">Categories (4, object): [(-5, -1] &lt; (-1, 0] &lt; (0, 1] &lt; (1, 5]]</span>
</pre></div>
</div>
<p><a class="reference internal" href="generated/pandas.qcut.html#pandas.qcut" title="pandas.qcut"><code class="xref py py-func docutils literal"><span class="pre">qcut()</span></code></a> computes sample quantiles. For example, we could slice up some
normally distributed data into equal-size quartiles like so:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [131]: </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>

<span class="gp">In [132]: </span><span class="n">factor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">75</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="gp">In [133]: </span><span class="n">factor</span>
<span class="gr">Out[133]: </span>
<span class="go">[(-0.139, 1.00736], (1.00736, 1.976], (1.00736, 1.976], [-1.0705, -0.439], [-1.0705, -0.439], ..., (1.00736, 1.976], [-1.0705, -0.439], (-0.439, -0.139], (-0.439, -0.139], (-0.439, -0.139]]</span>
<span class="go">Length: 30</span>
<span class="go">Categories (4, object): [[-1.0705, -0.439] &lt; (-0.439, -0.139] &lt; (-0.139, 1.00736] &lt; (1.00736, 1.976]]</span>

<span class="gp">In [134]: </span><span class="n">pd</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
<span class="gr">Out[134]: </span>
<span class="go">(1.00736, 1.976]     8</span>
<span class="go">[-1.0705, -0.439]    8</span>
<span class="go">(-0.139, 1.00736]    7</span>
<span class="go">(-0.439, -0.139]     7</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
<p>We can also pass infinite values to define the bins:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [135]: </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

<span class="gp">In [136]: </span><span class="n">factor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>

<span class="gp">In [137]: </span><span class="n">factor</span>
<span class="gr">Out[137]: </span>
<span class="go">[(-inf, 0], (0, inf], (0, inf], (0, inf], (-inf, 0], ..., (-inf, 0], (0, inf], (-inf, 0], (-inf, 0], (0, inf]]</span>
<span class="go">Length: 20</span>
<span class="go">Categories (2, object): [(-inf, 0] &lt; (0, inf]]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="function-application">
<span id="basics-apply"></span><h2>Function application<a class="headerlink" href="#function-application" title="Permalink to this headline">¶</a></h2>
<p>To apply your own or another library&#8217;s functions to pandas objects,
you should be aware of the three methods below. The appropriate
method to use depends on whether your function expects to operate
on an entire <code class="docutils literal"><span class="pre">DataFrame</span></code> or <code class="docutils literal"><span class="pre">Series</span></code>, row- or column-wise, or elementwise.</p>
<ol class="arabic simple">
<li><a class="reference internal" href="#tablewise-function-application">Tablewise Function Application</a>: <a class="reference internal" href="generated/pandas.DataFrame.pipe.html#pandas.DataFrame.pipe" title="pandas.DataFrame.pipe"><code class="xref py py-meth docutils literal"><span class="pre">pipe()</span></code></a></li>
<li><a class="reference internal" href="#row-or-column-wise-function-application">Row or Column-wise Function Application</a>: <a class="reference internal" href="generated/pandas.DataFrame.apply.html#pandas.DataFrame.apply" title="pandas.DataFrame.apply"><code class="xref py py-meth docutils literal"><span class="pre">apply()</span></code></a></li>
<li><a class="reference internal" href="#elementwise">Elementwise</a> function application: <a class="reference internal" href="generated/pandas.DataFrame.applymap.html#pandas.DataFrame.applymap" title="pandas.DataFrame.applymap"><code class="xref py py-meth docutils literal"><span class="pre">applymap()</span></code></a></li>
</ol>
<div class="section" id="tablewise-function-application">
<span id="basics-pipe"></span><h3>Tablewise Function Application<a class="headerlink" href="#tablewise-function-application" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.16.2.</span></p>
</div>
<p><code class="docutils literal"><span class="pre">DataFrames</span></code> and <code class="docutils literal"><span class="pre">Series</span></code> can of course just be passed into functions.
However, if the function needs to be called in a chain, consider using the <a class="reference internal" href="generated/pandas.DataFrame.pipe.html#pandas.DataFrame.pipe" title="pandas.DataFrame.pipe"><code class="xref py py-meth docutils literal"><span class="pre">pipe()</span></code></a> method.
Compare the following</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># f, g, and h are functions taking and returning ``DataFrames``</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">h</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="n">arg1</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">arg2</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">arg3</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>with the equivalent</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">       .pipe(g, arg1=1)</span>
<span class="go">       .pipe(f, arg2=2, arg3=3)</span>
<span class="go">    )</span>
</pre></div>
</div>
<p>Pandas encourages the second style, which is known as method chaining.
<code class="docutils literal"><span class="pre">pipe</span></code> makes it easy to use your own or another library&#8217;s functions
in method chains, alongside pandas&#8217; methods.</p>
<p>In the example above, the functions <code class="docutils literal"><span class="pre">f</span></code>, <code class="docutils literal"><span class="pre">g</span></code>, and <code class="docutils literal"><span class="pre">h</span></code> each expected the <code class="docutils literal"><span class="pre">DataFrame</span></code> as the first positional argument.
What if the function you wish to apply takes its data as, say, the second argument?
In this case, provide <code class="docutils literal"><span class="pre">pipe</span></code> with a tuple of <code class="docutils literal"><span class="pre">(callable,</span> <span class="pre">data_keyword)</span></code>.
<code class="docutils literal"><span class="pre">.pipe</span></code> will route the <code class="docutils literal"><span class="pre">DataFrame</span></code> to the argument specified in the tuple.</p>
<p>For example, we can fit a regression using statsmodels. Their API expects a formula first and a <code class="docutils literal"><span class="pre">DataFrame</span></code> as the second argument, <code class="docutils literal"><span class="pre">data</span></code>. We pass in the function, keyword pair <code class="docutils literal"><span class="pre">(sm.poisson,</span> <span class="pre">'data')</span></code> to <code class="docutils literal"><span class="pre">pipe</span></code>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [138]: </span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">as</span> <span class="nn">sm</span>

<span class="gp">In [139]: </span><span class="n">bb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/baseball.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>

<span class="gp">In [140]: </span><span class="p">(</span><span class="n">bb</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;h &gt; 0&#39;</span><span class="p">)</span>
<span class="gp">   .....:</span>    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">ln_h</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">h</span><span class="p">))</span>
<span class="gp">   .....:</span>    <span class="o">.</span><span class="n">pipe</span><span class="p">((</span><span class="n">sm</span><span class="o">.</span><span class="n">poisson</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">),</span> <span class="s1">&#39;hr ~ ln_h + year + g + C(lg)&#39;</span><span class="p">)</span>
<span class="gp">   .....:</span>    <span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gp">   .....:</span>    <span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="gp">   .....:</span> <span class="p">)</span>
<span class="gp">   .....:</span> 
<span class="go">Optimization terminated successfully.</span>
<span class="go">         Current function value: 2.116284</span>
<span class="go">         Iterations 24</span>
<span class="gr">Out[140]: </span>
<span class="go">&lt;class &#39;statsmodels.iolib.summary.Summary&#39;&gt;</span>
<span class="go">&quot;&quot;&quot;</span>
<span class="go">                          Poisson Regression Results                          </span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                     hr   No. Observations:                   68</span>
<span class="go">Model:                        Poisson   Df Residuals:                       63</span>
<span class="go">Method:                           MLE   Df Model:                            4</span>
<span class="go">Date:                Sat, 24 Dec 2016   Pseudo R-squ.:                  0.6878</span>
<span class="go">Time:                        18:31:33   Log-Likelihood:                -143.91</span>
<span class="go">converged:                       True   LL-Null:                       -460.91</span>
<span class="go">                                        LLR p-value:                6.774e-136</span>
<span class="go">===============================================================================</span>
<span class="go">                  coef    std err          z      P&gt;|z|      [95.0% Conf. Int.]</span>
<span class="go">-------------------------------------------------------------------------------</span>
<span class="go">Intercept   -1267.3636    457.867     -2.768      0.006     -2164.767  -369.960</span>
<span class="go">C(lg)[T.NL]    -0.2057      0.101     -2.044      0.041        -0.403    -0.008</span>
<span class="go">ln_h            0.9280      0.191      4.866      0.000         0.554     1.302</span>
<span class="go">year            0.6301      0.228      2.762      0.006         0.183     1.077</span>
<span class="go">g               0.0099      0.004      2.754      0.006         0.003     0.017</span>
<span class="go">===============================================================================</span>
<span class="go">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>The pipe method is inspired by unix pipes and more recently <a class="reference external" href="https://github.com/hadley/dplyr">dplyr</a> and <a class="reference external" href="https://github.com/smbache/magrittr">magrittr</a>, which
have introduced the popular <code class="docutils literal"><span class="pre">(%&gt;%)</span></code> (read pipe) operator for <a class="reference external" href="http://www.r-project.org">R</a>.
The implementation of <code class="docutils literal"><span class="pre">pipe</span></code> here is quite clean and feels right at home in python.
We encourage you to view the source code (<code class="docutils literal"><span class="pre">pd.DataFrame.pipe??</span></code> in IPython).</p>
</div>
<div class="section" id="row-or-column-wise-function-application">
<h3>Row or Column-wise Function Application<a class="headerlink" href="#row-or-column-wise-function-application" title="Permalink to this headline">¶</a></h3>
<p>Arbitrary functions can be applied along the axes of a DataFrame or Panel
using the <a class="reference internal" href="generated/pandas.DataFrame.apply.html#pandas.DataFrame.apply" title="pandas.DataFrame.apply"><code class="xref py py-meth docutils literal"><span class="pre">apply()</span></code></a> method, which, like the descriptive
statistics methods, take an optional <code class="docutils literal"><span class="pre">axis</span></code> argument:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [141]: </span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
<span class="gr">Out[141]: </span>
<span class="go">one     -0.251274</span>
<span class="go">three    0.469799</span>
<span class="go">two     -0.191421</span>
<span class="go">dtype: float64</span>

<span class="gp">In [142]: </span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gr">Out[142]: </span>
<span class="go">a   -0.489066</span>
<span class="go">b    0.273355</span>
<span class="go">c    0.008348</span>
<span class="go">d    0.011457</span>
<span class="go">dtype: float64</span>

<span class="gp">In [143]: </span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="gr">Out[143]: </span>
<span class="go">one      0.638161</span>
<span class="go">three    1.301762</span>
<span class="go">two      2.237808</span>
<span class="go">dtype: float64</span>

<span class="gp">In [144]: </span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">)</span>
<span class="gr">Out[144]: </span>
<span class="go">        one     three       two</span>
<span class="go">a -0.626544       NaN -0.351587</span>
<span class="go">b -0.765438 -0.177289  0.784662</span>
<span class="go">c -0.753821  0.284925  0.335874</span>
<span class="go">d       NaN  1.409398 -0.765684</span>

<span class="gp">In [145]: </span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">)</span>
<span class="gr">Out[145]: </span>
<span class="go">        one     three       two</span>
<span class="go">a  0.534436       NaN  0.703570</span>
<span class="go">b  0.870320  0.837537  3.115063</span>
<span class="go">c  1.011685  1.587586  0.638401</span>
<span class="go">d       NaN  3.078592  0.332353</span>
</pre></div>
</div>
<p>Depending on the return type of the function passed to <a class="reference internal" href="generated/pandas.DataFrame.apply.html#pandas.DataFrame.apply" title="pandas.DataFrame.apply"><code class="xref py py-meth docutils literal"><span class="pre">apply()</span></code></a>,
the result will either be of lower dimension or the same dimension.</p>
<p><a class="reference internal" href="generated/pandas.DataFrame.apply.html#pandas.DataFrame.apply" title="pandas.DataFrame.apply"><code class="xref py py-meth docutils literal"><span class="pre">apply()</span></code></a> combined with some cleverness can be used to answer many questions
about a data set. For example, suppose we wanted to extract the date where the
maximum value for each column occurred:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [146]: </span><span class="n">tsdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span>
<span class="gp">   .....:</span>                     <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;1/1/2000&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">1000</span><span class="p">))</span>
<span class="gp">   .....:</span> 

<span class="gp">In [147]: </span><span class="n">tsdf</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">idxmax</span><span class="p">())</span>
<span class="gr">Out[147]: </span>
<span class="go">A   2001-04-27</span>
<span class="go">B   2002-06-02</span>
<span class="go">C   2000-04-02</span>
<span class="go">dtype: datetime64[ns]</span>
</pre></div>
</div>
<p>You may also pass additional arguments and keyword arguments to the <a class="reference internal" href="generated/pandas.DataFrame.apply.html#pandas.DataFrame.apply" title="pandas.DataFrame.apply"><code class="xref py py-meth docutils literal"><span class="pre">apply()</span></code></a>
method. For instance, consider the following function you would like to apply:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">subtract_and_divide</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">divide</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">sub</span><span class="p">)</span> <span class="o">/</span> <span class="n">divide</span>
</pre></div>
</div>
<p>You may then apply this function as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">subtract_and_divide</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,),</span> <span class="n">divide</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Another useful feature is the ability to pass Series methods to carry out some
Series operation on each column or row:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [148]: </span><span class="n">tsdf</span>
<span class="gr">Out[148]: </span>
<span class="go">                   A         B         C</span>
<span class="go">2000-01-01  1.796883 -0.930690  3.542846</span>
<span class="go">2000-01-02 -1.242888 -0.695279 -1.000884</span>
<span class="go">2000-01-03 -0.720299  0.546303 -0.082042</span>
<span class="go">2000-01-04       NaN       NaN       NaN</span>
<span class="go">2000-01-05       NaN       NaN       NaN</span>
<span class="go">2000-01-06       NaN       NaN       NaN</span>
<span class="go">2000-01-07       NaN       NaN       NaN</span>
<span class="go">2000-01-08 -0.527402  0.933507  0.129646</span>
<span class="go">2000-01-09 -0.338903 -1.265452 -1.969004</span>
<span class="go">2000-01-10  0.532566  0.341548  0.150493</span>

<span class="gp">In [149]: </span><span class="n">tsdf</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="o">.</span><span class="n">interpolate</span><span class="p">)</span>
<span class="gr">Out[149]: </span>
<span class="go">                   A         B         C</span>
<span class="go">2000-01-01  1.796883 -0.930690  3.542846</span>
<span class="go">2000-01-02 -1.242888 -0.695279 -1.000884</span>
<span class="go">2000-01-03 -0.720299  0.546303 -0.082042</span>
<span class="go">2000-01-04 -0.681720  0.623743 -0.039704</span>
<span class="go">2000-01-05 -0.643140  0.701184  0.002633</span>
<span class="go">2000-01-06 -0.604561  0.778625  0.044971</span>
<span class="go">2000-01-07 -0.565982  0.856066  0.087309</span>
<span class="go">2000-01-08 -0.527402  0.933507  0.129646</span>
<span class="go">2000-01-09 -0.338903 -1.265452 -1.969004</span>
<span class="go">2000-01-10  0.532566  0.341548  0.150493</span>
</pre></div>
</div>
<p>Finally, <a class="reference internal" href="generated/pandas.DataFrame.apply.html#pandas.DataFrame.apply" title="pandas.DataFrame.apply"><code class="xref py py-meth docutils literal"><span class="pre">apply()</span></code></a> takes an argument <code class="docutils literal"><span class="pre">raw</span></code> which is False by default, which
converts each row or column into a Series before applying the function. When
set to True, the passed function will instead receive an ndarray object, which
has positive performance implications if you do not need the indexing
functionality.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The section on <a class="reference internal" href="groupby.html#groupby"><span class="std std-ref">GroupBy</span></a> demonstrates related, flexible
functionality for grouping by some criterion, applying, and combining the
results into a Series, DataFrame, etc.</p>
</div>
</div>
<div class="section" id="applying-elementwise-python-functions">
<span id="elementwise"></span><h3>Applying elementwise Python functions<a class="headerlink" href="#applying-elementwise-python-functions" title="Permalink to this headline">¶</a></h3>
<p>Since not all functions can be vectorized (accept NumPy arrays and return
another array or value), the methods <a class="reference internal" href="generated/pandas.DataFrame.applymap.html#pandas.DataFrame.applymap" title="pandas.DataFrame.applymap"><code class="xref py py-meth docutils literal"><span class="pre">applymap()</span></code></a> on DataFrame
and analogously <a class="reference internal" href="generated/pandas.Series.map.html#pandas.Series.map" title="pandas.Series.map"><code class="xref py py-meth docutils literal"><span class="pre">map()</span></code></a> on Series accept any Python function taking
a single value and returning a single value. For example:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [150]: </span><span class="n">df4</span>
<span class="gr">Out[150]: </span>
<span class="go">        one     three       two</span>
<span class="go">a -0.626544       NaN -0.351587</span>
<span class="go">b -0.138894 -0.177289  1.136249</span>
<span class="go">c  0.011617  0.462215 -0.448789</span>
<span class="go">d       NaN  1.124472 -1.101558</span>

<span class="gp">In [151]: </span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="gp">In [152]: </span><span class="n">df4</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gr">Out[152]: </span>
<span class="go">a    14</span>
<span class="go">b    15</span>
<span class="go">c    15</span>
<span class="go">d     3</span>
<span class="go">Name: one, dtype: int64</span>

<span class="gp">In [153]: </span><span class="n">df4</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gr">Out[153]: </span>
<span class="go">   one  three  two</span>
<span class="go">a   14      3   15</span>
<span class="go">b   15     15   11</span>
<span class="go">c   15     14   15</span>
<span class="go">d    3     13   14</span>
</pre></div>
</div>
<p><a class="reference internal" href="generated/pandas.Series.map.html#pandas.Series.map" title="pandas.Series.map"><code class="xref py py-meth docutils literal"><span class="pre">Series.map()</span></code></a> has an additional feature which is that it can be used to easily
&#8220;link&#8221; or &#8220;map&#8221; values defined by a secondary series. This is closely related
to <a class="reference internal" href="merging.html#merging"><span class="std std-ref">merging/joining functionality</span></a>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [154]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;six&#39;</span><span class="p">,</span> <span class="s1">&#39;seven&#39;</span><span class="p">,</span> <span class="s1">&#39;six&#39;</span><span class="p">,</span> <span class="s1">&#39;seven&#39;</span><span class="p">,</span> <span class="s1">&#39;six&#39;</span><span class="p">],</span>
<span class="gp">   .....:</span>               <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">   .....:</span> 

<span class="gp">In [155]: </span><span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;six&#39;</span> <span class="p">:</span> <span class="mf">6.</span><span class="p">,</span> <span class="s1">&#39;seven&#39;</span> <span class="p">:</span> <span class="mf">7.</span><span class="p">})</span>

<span class="gp">In [156]: </span><span class="n">s</span>
<span class="gr">Out[156]: </span>
<span class="go">a      six</span>
<span class="go">b    seven</span>
<span class="go">c      six</span>
<span class="go">d    seven</span>
<span class="go">e      six</span>
<span class="go">dtype: object</span>

<span class="gp">In [157]: </span><span class="n">s</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="gr">Out[157]: </span>
<span class="go">a    6.0</span>
<span class="go">b    7.0</span>
<span class="go">c    6.0</span>
<span class="go">d    7.0</span>
<span class="go">e    6.0</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</div>
<div class="section" id="applying-with-a-panel">
<span id="basics-apply-panel"></span><h3>Applying with a Panel<a class="headerlink" href="#applying-with-a-panel" title="Permalink to this headline">¶</a></h3>
<p>Applying with a <code class="docutils literal"><span class="pre">Panel</span></code> will pass a <code class="docutils literal"><span class="pre">Series</span></code> to the applied function. If the applied
function returns a <code class="docutils literal"><span class="pre">Series</span></code>, the result of the application will be a <code class="docutils literal"><span class="pre">Panel</span></code>. If the applied function
reduces to a scalar, the result of the application will be a <code class="docutils literal"><span class="pre">DataFrame</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Prior to 0.13.1 <code class="docutils literal"><span class="pre">apply</span></code> on a <code class="docutils literal"><span class="pre">Panel</span></code> would only work on <code class="docutils literal"><span class="pre">ufuncs</span></code> (e.g. <code class="docutils literal"><span class="pre">np.sum/np.max</span></code>).</p>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [158]: </span><span class="kn">import</span> <span class="nn">pandas.util.testing</span> <span class="kn">as</span> <span class="nn">tm</span>

<span class="gp">In [159]: </span><span class="n">panel</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">makePanel</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="gp">In [160]: </span><span class="n">panel</span>
<span class="gr">Out[160]: </span>
<span class="go">&lt;class &#39;pandas.core.panel.Panel&#39;&gt;</span>
<span class="go">Dimensions: 3 (items) x 5 (major_axis) x 4 (minor_axis)</span>
<span class="go">Items axis: ItemA to ItemC</span>
<span class="go">Major_axis axis: 2000-01-03 00:00:00 to 2000-01-07 00:00:00</span>
<span class="go">Minor_axis axis: A to D</span>

<span class="gp">In [161]: </span><span class="n">panel</span><span class="p">[</span><span class="s1">&#39;ItemA&#39;</span><span class="p">]</span>
<span class="gr">Out[161]: </span>
<span class="go">                   A         B         C         D</span>
<span class="go">2000-01-03  0.330418  1.893177  0.801111  0.528154</span>
<span class="go">2000-01-04  1.761200  0.170247  0.445614 -0.029371</span>
<span class="go">2000-01-05  0.567133 -0.916844  1.453046 -0.631117</span>
<span class="go">2000-01-06 -0.251020  0.835024  2.430373 -0.172441</span>
<span class="go">2000-01-07  1.020099  1.259919  0.653093 -1.020485</span>
</pre></div>
</div>
<p>A transformational apply.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [162]: </span><span class="n">result</span> <span class="o">=</span> <span class="n">panel</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;items&#39;</span><span class="p">)</span>

<span class="gp">In [163]: </span><span class="n">result</span>
<span class="gr">Out[163]: </span>
<span class="go">&lt;class &#39;pandas.core.panel.Panel&#39;&gt;</span>
<span class="go">Dimensions: 3 (items) x 5 (major_axis) x 4 (minor_axis)</span>
<span class="go">Items axis: ItemA to ItemC</span>
<span class="go">Major_axis axis: 2000-01-03 00:00:00 to 2000-01-07 00:00:00</span>
<span class="go">Minor_axis axis: A to D</span>

<span class="gp">In [164]: </span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;ItemA&#39;</span><span class="p">]</span>
<span class="gr">Out[164]: </span>
<span class="go">                   A         B         C         D</span>
<span class="go">2000-01-03  0.660836  3.786354  1.602222  1.056308</span>
<span class="go">2000-01-04  3.522400  0.340494  0.891228 -0.058742</span>
<span class="go">2000-01-05  1.134266 -1.833689  2.906092 -1.262234</span>
<span class="go">2000-01-06 -0.502039  1.670047  4.860747 -0.344882</span>
<span class="go">2000-01-07  2.040199  2.519838  1.306185 -2.040969</span>
</pre></div>
</div>
<p>A reduction operation.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [165]: </span><span class="n">panel</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;items&#39;</span><span class="p">)</span>
<span class="gr">Out[165]: </span>
<span class="go">                  A        B        C        D</span>
<span class="go">2000-01-03  float64  float64  float64  float64</span>
<span class="go">2000-01-04  float64  float64  float64  float64</span>
<span class="go">2000-01-05  float64  float64  float64  float64</span>
<span class="go">2000-01-06  float64  float64  float64  float64</span>
<span class="go">2000-01-07  float64  float64  float64  float64</span>
</pre></div>
</div>
<p>A similar reduction type operation</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [166]: </span><span class="n">panel</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;major_axis&#39;</span><span class="p">)</span>
<span class="gr">Out[166]: </span>
<span class="go">      ItemA     ItemB     ItemC</span>
<span class="go">A  3.427831 -2.581431  0.840809</span>
<span class="go">B  3.241522 -1.409935 -1.114512</span>
<span class="go">C  5.783237  0.319672 -0.431906</span>
<span class="go">D -1.325260 -2.914834  0.857043</span>
</pre></div>
</div>
<p>This last reduction is equivalent to</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [167]: </span><span class="n">panel</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;major_axis&#39;</span><span class="p">)</span>
<span class="gr">Out[167]: </span>
<span class="go">      ItemA     ItemB     ItemC</span>
<span class="go">A  3.427831 -2.581431  0.840809</span>
<span class="go">B  3.241522 -1.409935 -1.114512</span>
<span class="go">C  5.783237  0.319672 -0.431906</span>
<span class="go">D -1.325260 -2.914834  0.857043</span>
</pre></div>
</div>
<p>A transformation operation that returns a <code class="docutils literal"><span class="pre">Panel</span></code>, but is computing
the z-score across the <code class="docutils literal"><span class="pre">major_axis</span></code>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [168]: </span><span class="n">result</span> <span class="o">=</span> <span class="n">panel</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
<span class="gp">   .....:</span>            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span>
<span class="gp">   .....:</span>            <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;major_axis&#39;</span><span class="p">)</span>
<span class="gp">   .....:</span> 

<span class="gp">In [169]: </span><span class="n">result</span>
<span class="gr">Out[169]: </span>
<span class="go">&lt;class &#39;pandas.core.panel.Panel&#39;&gt;</span>
<span class="go">Dimensions: 3 (items) x 5 (major_axis) x 4 (minor_axis)</span>
<span class="go">Items axis: ItemA to ItemC</span>
<span class="go">Major_axis axis: 2000-01-03 00:00:00 to 2000-01-07 00:00:00</span>
<span class="go">Minor_axis axis: A to D</span>

<span class="gp">In [170]: </span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;ItemA&#39;</span><span class="p">]</span>
<span class="gr">Out[170]: </span>
<span class="go">                   A         B         C         D</span>
<span class="go">2000-01-03 -0.469761  1.156225 -0.441347  1.341731</span>
<span class="go">2000-01-04  1.422763 -0.444015 -0.882647  0.398661</span>
<span class="go">2000-01-05 -0.156654 -1.453694  0.367936 -0.619210</span>
<span class="go">2000-01-06 -1.238841  0.173423  1.581149  0.156654</span>
<span class="go">2000-01-07  0.442494  0.568061 -0.625091 -1.277837</span>
</pre></div>
</div>
<p>Apply can also accept multiple axes in the <code class="docutils literal"><span class="pre">axis</span></code> argument. This will pass a
<code class="docutils literal"><span class="pre">DataFrame</span></code> of the cross-section to the applied function.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [171]: </span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>

<span class="gp">In [172]: </span><span class="n">result</span> <span class="o">=</span> <span class="n">panel</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;items&#39;</span><span class="p">,</span><span class="s1">&#39;major_axis&#39;</span><span class="p">])</span>

<span class="gp">In [173]: </span><span class="n">result</span>
<span class="gr">Out[173]: </span>
<span class="go">&lt;class &#39;pandas.core.panel.Panel&#39;&gt;</span>
<span class="go">Dimensions: 4 (items) x 5 (major_axis) x 3 (minor_axis)</span>
<span class="go">Items axis: A to D</span>
<span class="go">Major_axis axis: 2000-01-03 00:00:00 to 2000-01-07 00:00:00</span>
<span class="go">Minor_axis axis: ItemA to ItemC</span>

<span class="gp">In [174]: </span><span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,:,</span><span class="s1">&#39;ItemA&#39;</span><span class="p">]</span>
<span class="gr">Out[174]: </span>
<span class="go">                   A         B         C         D</span>
<span class="go">2000-01-03  0.864236  1.132969  0.557316  0.575106</span>
<span class="go">2000-01-04  0.795745  0.652527  0.534808 -0.070674</span>
<span class="go">2000-01-05 -0.310864  0.558627  1.086688 -1.051477</span>
<span class="go">2000-01-06 -0.001065  0.832460  0.846006  0.043602</span>
<span class="go">2000-01-07  1.128946  1.152469 -0.218186 -0.891680</span>
</pre></div>
</div>
<p>This is equivalent to the following</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [175]: </span><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="nb">dict</span><span class="p">([</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">panel</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,:,</span><span class="n">ax</span><span class="p">]))</span>
<span class="gp">   .....:</span>                         <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">panel</span><span class="o">.</span><span class="n">minor_axis</span> <span class="p">]))</span>
<span class="gp">   .....:</span> 

<span class="gp">In [176]: </span><span class="n">result</span>
<span class="gr">Out[176]: </span>
<span class="go">&lt;class &#39;pandas.core.panel.Panel&#39;&gt;</span>
<span class="go">Dimensions: 4 (items) x 5 (major_axis) x 3 (minor_axis)</span>
<span class="go">Items axis: A to D</span>
<span class="go">Major_axis axis: 2000-01-03 00:00:00 to 2000-01-07 00:00:00</span>
<span class="go">Minor_axis axis: ItemA to ItemC</span>

<span class="gp">In [177]: </span><span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,:,</span><span class="s1">&#39;ItemA&#39;</span><span class="p">]</span>
<span class="gr">Out[177]: </span>
<span class="go">                   A         B         C         D</span>
<span class="go">2000-01-03  0.864236  1.132969  0.557316  0.575106</span>
<span class="go">2000-01-04  0.795745  0.652527  0.534808 -0.070674</span>
<span class="go">2000-01-05 -0.310864  0.558627  1.086688 -1.051477</span>
<span class="go">2000-01-06 -0.001065  0.832460  0.846006  0.043602</span>
<span class="go">2000-01-07  1.128946  1.152469 -0.218186 -0.891680</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="reindexing-and-altering-labels">
<span id="basics-reindexing"></span><h2>Reindexing and altering labels<a class="headerlink" href="#reindexing-and-altering-labels" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="generated/pandas.Series.reindex.html#pandas.Series.reindex" title="pandas.Series.reindex"><code class="xref py py-meth docutils literal"><span class="pre">reindex()</span></code></a> is the fundamental data alignment method in pandas.
It is used to implement nearly all other features relying on label-alignment
functionality. To <em>reindex</em> means to conform the data to match a given set of
labels along a particular axis. This accomplishes several things:</p>
<blockquote>
<div><ul class="simple">
<li>Reorders the existing data to match a new set of labels</li>
<li>Inserts missing value (NA) markers in label locations where no data for
that label existed</li>
<li>If specified, <strong>fill</strong> data for missing labels using logic (highly relevant
to working with time series data)</li>
</ul>
</div></blockquote>
<p>Here is a simple example:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [178]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>

<span class="gp">In [179]: </span><span class="n">s</span>
<span class="gr">Out[179]: </span>
<span class="go">a   -1.010924</span>
<span class="go">b   -0.672504</span>
<span class="go">c   -1.139222</span>
<span class="go">d    0.354653</span>
<span class="go">e    0.563622</span>
<span class="go">dtype: float64</span>

<span class="gp">In [180]: </span><span class="n">s</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gr">Out[180]: </span>
<span class="go">e    0.563622</span>
<span class="go">b   -0.672504</span>
<span class="go">f         NaN</span>
<span class="go">d    0.354653</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<p>Here, the <code class="docutils literal"><span class="pre">f</span></code> label was not contained in the Series and hence appears as
<code class="docutils literal"><span class="pre">NaN</span></code> in the result.</p>
<p>With a DataFrame, you can simultaneously reindex the index and columns:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [181]: </span><span class="n">df</span>
<span class="gr">Out[181]: </span>
<span class="go">        one     three       two</span>
<span class="go">a -0.626544       NaN -0.351587</span>
<span class="go">b -0.138894 -0.177289  1.136249</span>
<span class="go">c  0.011617  0.462215 -0.448789</span>
<span class="go">d       NaN  1.124472 -1.101558</span>

<span class="gp">In [182]: </span><span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">])</span>
<span class="gr">Out[182]: </span>
<span class="go">      three       two       one</span>
<span class="go">c  0.462215 -0.448789  0.011617</span>
<span class="go">f       NaN       NaN       NaN</span>
<span class="go">b -0.177289  1.136249 -0.138894</span>
</pre></div>
</div>
<p>For convenience, you may utilize the <a class="reference internal" href="generated/pandas.Series.reindex_axis.html#pandas.Series.reindex_axis" title="pandas.Series.reindex_axis"><code class="xref py py-meth docutils literal"><span class="pre">reindex_axis()</span></code></a> method, which
takes the labels and a keyword <code class="docutils literal"><span class="pre">axis</span></code> parameter.</p>
<p>Note that the <code class="docutils literal"><span class="pre">Index</span></code> objects containing the actual axis labels can be
<strong>shared</strong> between objects. So if we have a Series and a DataFrame, the
following can be done:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [183]: </span><span class="n">rs</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="gp">In [184]: </span><span class="n">rs</span>
<span class="gr">Out[184]: </span>
<span class="go">a   -1.010924</span>
<span class="go">b   -0.672504</span>
<span class="go">c   -1.139222</span>
<span class="go">d    0.354653</span>
<span class="go">dtype: float64</span>

<span class="gp">In [185]: </span><span class="n">rs</span><span class="o">.</span><span class="n">index</span> <span class="ow">is</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
<span class="gr">Out[185]: </span><span class="bp">True</span>
</pre></div>
</div>
<p>This means that the reindexed Series&#8217;s index is the same Python object as the
DataFrame&#8217;s index.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="advanced.html#advanced"><span class="std std-ref">MultiIndex / Advanced Indexing</span></a> is an even more concise way of
doing reindexing.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When writing performance-sensitive code, there is a good reason to spend
some time becoming a reindexing ninja: <strong>many operations are faster on
pre-aligned data</strong>. Adding two unaligned DataFrames internally triggers a
reindexing step. For exploratory analysis you will hardly notice the
difference (because <code class="docutils literal"><span class="pre">reindex</span></code> has been heavily optimized), but when CPU
cycles matter sprinkling a few explicit <code class="docutils literal"><span class="pre">reindex</span></code> calls here and there can
have an impact.</p>
</div>
<div class="section" id="reindexing-to-align-with-another-object">
<span id="basics-reindex-like"></span><h3>Reindexing to align with another object<a class="headerlink" href="#reindexing-to-align-with-another-object" title="Permalink to this headline">¶</a></h3>
<p>You may wish to take an object and reindex its axes to be labeled the same as
another object. While the syntax for this is straightforward albeit verbose, it
is a common enough operation that the <a class="reference internal" href="generated/pandas.DataFrame.reindex_like.html#pandas.DataFrame.reindex_like" title="pandas.DataFrame.reindex_like"><code class="xref py py-meth docutils literal"><span class="pre">reindex_like()</span></code></a> method is
available to make this simpler:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [186]: </span><span class="n">df2</span>
<span class="gr">Out[186]: </span>
<span class="go">        one       two</span>
<span class="go">a -0.626544 -0.351587</span>
<span class="go">b -0.138894  1.136249</span>
<span class="go">c  0.011617 -0.448789</span>

<span class="gp">In [187]: </span><span class="n">df3</span>
<span class="gr">Out[187]: </span>
<span class="go">        one       two</span>
<span class="go">a -0.375270 -0.463545</span>
<span class="go">b  0.112379  1.024292</span>
<span class="go">c  0.262891 -0.560746</span>

<span class="gp">In [188]: </span><span class="n">df</span><span class="o">.</span><span class="n">reindex_like</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="gr">Out[188]: </span>
<span class="go">        one       two</span>
<span class="go">a -0.626544 -0.351587</span>
<span class="go">b -0.138894  1.136249</span>
<span class="go">c  0.011617 -0.448789</span>
</pre></div>
</div>
</div>
<div class="section" id="aligning-objects-with-each-other-with-align">
<span id="basics-align"></span><h3>Aligning objects with each other with <code class="docutils literal"><span class="pre">align</span></code><a class="headerlink" href="#aligning-objects-with-each-other-with-align" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="generated/pandas.Series.align.html#pandas.Series.align" title="pandas.Series.align"><code class="xref py py-meth docutils literal"><span class="pre">align()</span></code></a> method is the fastest way to simultaneously align two objects. It
supports a <code class="docutils literal"><span class="pre">join</span></code> argument (related to <a class="reference internal" href="merging.html#merging"><span class="std std-ref">joining and merging</span></a>):</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">join='outer'</span></code>: take the union of the indexes (default)</li>
<li><code class="docutils literal"><span class="pre">join='left'</span></code>: use the calling object&#8217;s index</li>
<li><code class="docutils literal"><span class="pre">join='right'</span></code>: use the passed object&#8217;s index</li>
<li><code class="docutils literal"><span class="pre">join='inner'</span></code>: intersect the indexes</li>
</ul>
</div></blockquote>
<p>It returns a tuple with both of the reindexed Series:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [189]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>

<span class="gp">In [190]: </span><span class="n">s1</span> <span class="o">=</span> <span class="n">s</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>

<span class="gp">In [191]: </span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

<span class="gp">In [192]: </span><span class="n">s1</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="gr">Out[192]: </span>
<span class="go">(a   -0.365106</span>
<span class="go"> b    1.092702</span>
<span class="go"> c   -1.481449</span>
<span class="go"> d    1.781190</span>
<span class="go"> e         NaN</span>
<span class="go"> dtype: float64, a         NaN</span>
<span class="go"> b    1.092702</span>
<span class="go"> c   -1.481449</span>
<span class="go"> d    1.781190</span>
<span class="go"> e   -0.031543</span>
<span class="go"> dtype: float64)</span>

<span class="gp">In [193]: </span><span class="n">s1</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="gr">Out[193]: </span>
<span class="go">(b    1.092702</span>
<span class="go"> c   -1.481449</span>
<span class="go"> d    1.781190</span>
<span class="go"> dtype: float64, b    1.092702</span>
<span class="go"> c   -1.481449</span>
<span class="go"> d    1.781190</span>
<span class="go"> dtype: float64)</span>

<span class="gp">In [194]: </span><span class="n">s1</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="gr">Out[194]: </span>
<span class="go">(a   -0.365106</span>
<span class="go"> b    1.092702</span>
<span class="go"> c   -1.481449</span>
<span class="go"> d    1.781190</span>
<span class="go"> dtype: float64, a         NaN</span>
<span class="go"> b    1.092702</span>
<span class="go"> c   -1.481449</span>
<span class="go"> d    1.781190</span>
<span class="go"> dtype: float64)</span>
</pre></div>
</div>
<p id="basics-df-join">For DataFrames, the join method will be applied to both the index and the
columns by default:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [195]: </span><span class="n">df</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="gr">Out[195]: </span>
<span class="go">(        one       two</span>
<span class="go"> a -0.626544 -0.351587</span>
<span class="go"> b -0.138894  1.136249</span>
<span class="go"> c  0.011617 -0.448789,         one       two</span>
<span class="go"> a -0.626544 -0.351587</span>
<span class="go"> b -0.138894  1.136249</span>
<span class="go"> c  0.011617 -0.448789)</span>
</pre></div>
</div>
<p>You can also pass an <code class="docutils literal"><span class="pre">axis</span></code> option to only align on the specified axis:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [196]: </span><span class="n">df</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gr">Out[196]: </span>
<span class="go">(        one     three       two</span>
<span class="go"> a -0.626544       NaN -0.351587</span>
<span class="go"> b -0.138894 -0.177289  1.136249</span>
<span class="go"> c  0.011617  0.462215 -0.448789,         one       two</span>
<span class="go"> a -0.626544 -0.351587</span>
<span class="go"> b -0.138894  1.136249</span>
<span class="go"> c  0.011617 -0.448789)</span>
</pre></div>
</div>
<p id="basics-align-frame-series">If you pass a Series to <a class="reference internal" href="generated/pandas.DataFrame.align.html#pandas.DataFrame.align" title="pandas.DataFrame.align"><code class="xref py py-meth docutils literal"><span class="pre">DataFrame.align()</span></code></a>, you can choose to align both
objects either on the DataFrame&#8217;s index or columns using the <code class="docutils literal"><span class="pre">axis</span></code> argument:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [197]: </span><span class="n">df</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gr">Out[197]: </span>
<span class="go">(        one     three       two</span>
<span class="go"> a -0.626544       NaN -0.351587</span>
<span class="go"> b -0.138894 -0.177289  1.136249</span>
<span class="go"> c  0.011617  0.462215 -0.448789</span>
<span class="go"> d       NaN  1.124472 -1.101558, one     -0.626544</span>
<span class="go"> three         NaN</span>
<span class="go"> two     -0.351587</span>
<span class="go"> Name: a, dtype: float64)</span>
</pre></div>
</div>
</div>
<div class="section" id="filling-while-reindexing">
<span id="basics-reindex-fill"></span><h3>Filling while reindexing<a class="headerlink" href="#filling-while-reindexing" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="generated/pandas.Series.reindex.html#pandas.Series.reindex" title="pandas.Series.reindex"><code class="xref py py-meth docutils literal"><span class="pre">reindex()</span></code></a> takes an optional parameter <code class="docutils literal"><span class="pre">method</span></code> which is a
filling method chosen from the following table:</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Action</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>pad / ffill</td>
<td>Fill values forward</td>
</tr>
<tr class="row-odd"><td>bfill / backfill</td>
<td>Fill values backward</td>
</tr>
<tr class="row-even"><td>nearest</td>
<td>Fill from the nearest index value</td>
</tr>
</tbody>
</table>
<p>We illustrate these fill methods on a simple Series:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [198]: </span><span class="n">rng</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;1/3/2000&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="gp">In [199]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>

<span class="gp">In [200]: </span><span class="n">ts2</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>

<span class="gp">In [201]: </span><span class="n">ts</span>
<span class="gr">Out[201]: </span>
<span class="go">2000-01-03    0.480993</span>
<span class="go">2000-01-04    0.604244</span>
<span class="go">2000-01-05   -0.487265</span>
<span class="go">2000-01-06    1.990533</span>
<span class="go">2000-01-07    0.327007</span>
<span class="go">2000-01-08    1.053639</span>
<span class="go">2000-01-09   -2.927808</span>
<span class="go">2000-01-10    0.082065</span>
<span class="go">Freq: D, dtype: float64</span>

<span class="gp">In [202]: </span><span class="n">ts2</span>
<span class="gr">Out[202]: </span>
<span class="go">2000-01-03    0.480993</span>
<span class="go">2000-01-06    1.990533</span>
<span class="go">2000-01-09   -2.927808</span>
<span class="go">dtype: float64</span>

<span class="gp">In [203]: </span><span class="n">ts2</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="gr">Out[203]: </span>
<span class="go">2000-01-03    0.480993</span>
<span class="go">2000-01-04         NaN</span>
<span class="go">2000-01-05         NaN</span>
<span class="go">2000-01-06    1.990533</span>
<span class="go">2000-01-07         NaN</span>
<span class="go">2000-01-08         NaN</span>
<span class="go">2000-01-09   -2.927808</span>
<span class="go">2000-01-10         NaN</span>
<span class="go">Freq: D, dtype: float64</span>

<span class="gp">In [204]: </span><span class="n">ts2</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span>
<span class="gr">Out[204]: </span>
<span class="go">2000-01-03    0.480993</span>
<span class="go">2000-01-04    0.480993</span>
<span class="go">2000-01-05    0.480993</span>
<span class="go">2000-01-06    1.990533</span>
<span class="go">2000-01-07    1.990533</span>
<span class="go">2000-01-08    1.990533</span>
<span class="go">2000-01-09   -2.927808</span>
<span class="go">2000-01-10   -2.927808</span>
<span class="go">Freq: D, dtype: float64</span>

<span class="gp">In [205]: </span><span class="n">ts2</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bfill&#39;</span><span class="p">)</span>
<span class="gr">Out[205]: </span>
<span class="go">2000-01-03    0.480993</span>
<span class="go">2000-01-04    1.990533</span>
<span class="go">2000-01-05    1.990533</span>
<span class="go">2000-01-06    1.990533</span>
<span class="go">2000-01-07   -2.927808</span>
<span class="go">2000-01-08   -2.927808</span>
<span class="go">2000-01-09   -2.927808</span>
<span class="go">2000-01-10         NaN</span>
<span class="go">Freq: D, dtype: float64</span>

<span class="gp">In [206]: </span><span class="n">ts2</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="gr">Out[206]: </span>
<span class="go">2000-01-03    0.480993</span>
<span class="go">2000-01-04    0.480993</span>
<span class="go">2000-01-05    1.990533</span>
<span class="go">2000-01-06    1.990533</span>
<span class="go">2000-01-07    1.990533</span>
<span class="go">2000-01-08   -2.927808</span>
<span class="go">2000-01-09   -2.927808</span>
<span class="go">2000-01-10   -2.927808</span>
<span class="go">Freq: D, dtype: float64</span>
</pre></div>
</div>
<p>These methods require that the indexes are <strong>ordered</strong> increasing or
decreasing.</p>
<p>Note that the same result could have been achieved using
<a class="reference internal" href="missing_data.html#missing-data-fillna"><span class="std std-ref">fillna</span></a> (except for <code class="docutils literal"><span class="pre">method='nearest'</span></code>) or
<a class="reference internal" href="missing_data.html#missing-data-interpolate"><span class="std std-ref">interpolate</span></a>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [207]: </span><span class="n">ts2</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span>
<span class="gr">Out[207]: </span>
<span class="go">2000-01-03    0.480993</span>
<span class="go">2000-01-04    0.480993</span>
<span class="go">2000-01-05    0.480993</span>
<span class="go">2000-01-06    1.990533</span>
<span class="go">2000-01-07    1.990533</span>
<span class="go">2000-01-08    1.990533</span>
<span class="go">2000-01-09   -2.927808</span>
<span class="go">2000-01-10   -2.927808</span>
<span class="go">Freq: D, dtype: float64</span>
</pre></div>
</div>
<p><a class="reference internal" href="generated/pandas.Series.reindex.html#pandas.Series.reindex" title="pandas.Series.reindex"><code class="xref py py-meth docutils literal"><span class="pre">reindex()</span></code></a> will raise a ValueError if the index is not monotonic
increasing or decreasing. <a class="reference internal" href="generated/pandas.Series.fillna.html#pandas.Series.fillna" title="pandas.Series.fillna"><code class="xref py py-meth docutils literal"><span class="pre">fillna()</span></code></a> and <a class="reference internal" href="generated/pandas.Series.interpolate.html#pandas.Series.interpolate" title="pandas.Series.interpolate"><code class="xref py py-meth docutils literal"><span class="pre">interpolate()</span></code></a>
will not make any checks on the order of the index.</p>
</div>
<div class="section" id="limits-on-filling-while-reindexing">
<span id="basics-limits-on-reindex-fill"></span><h3>Limits on filling while reindexing<a class="headerlink" href="#limits-on-filling-while-reindexing" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">limit</span></code> and <code class="docutils literal"><span class="pre">tolerance</span></code> arguments provide additional control over
filling while reindexing. Limit specifies the maximum count of consecutive
matches:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [208]: </span><span class="n">ts2</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gr">Out[208]: </span>
<span class="go">2000-01-03    0.480993</span>
<span class="go">2000-01-04    0.480993</span>
<span class="go">2000-01-05         NaN</span>
<span class="go">2000-01-06    1.990533</span>
<span class="go">2000-01-07    1.990533</span>
<span class="go">2000-01-08         NaN</span>
<span class="go">2000-01-09   -2.927808</span>
<span class="go">2000-01-10   -2.927808</span>
<span class="go">Freq: D, dtype: float64</span>
</pre></div>
</div>
<p>In contrast, tolerance specifies the maximum distance between the index and
indexer values:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [209]: </span><span class="n">ts2</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="s1">&#39;1 day&#39;</span><span class="p">)</span>
<span class="gr">Out[209]: </span>
<span class="go">2000-01-03    0.480993</span>
<span class="go">2000-01-04    0.480993</span>
<span class="go">2000-01-05         NaN</span>
<span class="go">2000-01-06    1.990533</span>
<span class="go">2000-01-07    1.990533</span>
<span class="go">2000-01-08         NaN</span>
<span class="go">2000-01-09   -2.927808</span>
<span class="go">2000-01-10   -2.927808</span>
<span class="go">Freq: D, dtype: float64</span>
</pre></div>
</div>
<p>Notice that when used on a <code class="docutils literal"><span class="pre">DatetimeIndex</span></code>, <code class="docutils literal"><span class="pre">TimedeltaIndex</span></code> or
<code class="docutils literal"><span class="pre">PeriodIndex</span></code>, <code class="docutils literal"><span class="pre">tolerance</span></code> will coerced into a <code class="docutils literal"><span class="pre">Timedelta</span></code> if possible.
This allows you to specify tolerance with appropriate strings.</p>
</div>
<div class="section" id="dropping-labels-from-an-axis">
<span id="basics-drop"></span><h3>Dropping labels from an axis<a class="headerlink" href="#dropping-labels-from-an-axis" title="Permalink to this headline">¶</a></h3>
<p>A method closely related to <code class="docutils literal"><span class="pre">reindex</span></code> is the <a class="reference internal" href="generated/pandas.DataFrame.drop.html#pandas.DataFrame.drop" title="pandas.DataFrame.drop"><code class="xref py py-meth docutils literal"><span class="pre">drop()</span></code></a> function.
It removes a set of labels from an axis:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [210]: </span><span class="n">df</span>
<span class="gr">Out[210]: </span>
<span class="go">        one     three       two</span>
<span class="go">a -0.626544       NaN -0.351587</span>
<span class="go">b -0.138894 -0.177289  1.136249</span>
<span class="go">c  0.011617  0.462215 -0.448789</span>
<span class="go">d       NaN  1.124472 -1.101558</span>

<span class="gp">In [211]: </span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gr">Out[211]: </span>
<span class="go">        one     three       two</span>
<span class="go">b -0.138894 -0.177289  1.136249</span>
<span class="go">c  0.011617  0.462215 -0.448789</span>

<span class="gp">In [212]: </span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;one&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gr">Out[212]: </span>
<span class="go">      three       two</span>
<span class="go">a       NaN -0.351587</span>
<span class="go">b -0.177289  1.136249</span>
<span class="go">c  0.462215 -0.448789</span>
<span class="go">d  1.124472 -1.101558</span>
</pre></div>
</div>
<p>Note that the following also works, but is a bit less obvious / clean:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [213]: </span><span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">difference</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]))</span>
<span class="gr">Out[213]: </span>
<span class="go">        one     three       two</span>
<span class="go">b -0.138894 -0.177289  1.136249</span>
<span class="go">c  0.011617  0.462215 -0.448789</span>
</pre></div>
</div>
</div>
<div class="section" id="renaming-mapping-labels">
<span id="basics-rename"></span><h3>Renaming / mapping labels<a class="headerlink" href="#renaming-mapping-labels" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="generated/pandas.DataFrame.rename.html#pandas.DataFrame.rename" title="pandas.DataFrame.rename"><code class="xref py py-meth docutils literal"><span class="pre">rename()</span></code></a> method allows you to relabel an axis based on some
mapping (a dict or Series) or an arbitrary function.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [214]: </span><span class="n">s</span>
<span class="gr">Out[214]: </span>
<span class="go">a   -0.365106</span>
<span class="go">b    1.092702</span>
<span class="go">c   -1.481449</span>
<span class="go">d    1.781190</span>
<span class="go">e   -0.031543</span>
<span class="go">dtype: float64</span>

<span class="gp">In [215]: </span><span class="n">s</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">upper</span><span class="p">)</span>
<span class="gr">Out[215]: </span>
<span class="go">A   -0.365106</span>
<span class="go">B    1.092702</span>
<span class="go">C   -1.481449</span>
<span class="go">D    1.781190</span>
<span class="go">E   -0.031543</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<p>If you pass a function, it must return a value when called with any of the
labels (and must produce a set of unique values). A dict or
Series can also be used:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [216]: </span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;one&#39;</span> <span class="p">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span> <span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">},</span>
<span class="gp">   .....:</span>           <span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;a&#39;</span> <span class="p">:</span> <span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="p">:</span> <span class="s1">&#39;banana&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span> <span class="p">:</span> <span class="s1">&#39;durian&#39;</span><span class="p">})</span>
<span class="gp">   .....:</span> 
<span class="gr">Out[216]: </span>
<span class="go">             foo     three       bar</span>
<span class="go">apple  -0.626544       NaN -0.351587</span>
<span class="go">banana -0.138894 -0.177289  1.136249</span>
<span class="go">c       0.011617  0.462215 -0.448789</span>
<span class="go">durian       NaN  1.124472 -1.101558</span>
</pre></div>
</div>
<p>If the mapping doesn&#8217;t include a column/index label, it isn&#8217;t renamed. Also
extra labels in the mapping don&#8217;t throw an error.</p>
<p>The <a class="reference internal" href="generated/pandas.DataFrame.rename.html#pandas.DataFrame.rename" title="pandas.DataFrame.rename"><code class="xref py py-meth docutils literal"><span class="pre">rename()</span></code></a> method also provides an <code class="docutils literal"><span class="pre">inplace</span></code> named
parameter that is by default <code class="docutils literal"><span class="pre">False</span></code> and copies the underlying data. Pass
<code class="docutils literal"><span class="pre">inplace=True</span></code> to rename the data in place.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.18.0.</span></p>
</div>
<p>Finally, <a class="reference internal" href="generated/pandas.Series.rename.html#pandas.Series.rename" title="pandas.Series.rename"><code class="xref py py-meth docutils literal"><span class="pre">rename()</span></code></a> also accepts a scalar or list-like
for altering the <code class="docutils literal"><span class="pre">Series.name</span></code> attribute.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [217]: </span><span class="n">s</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;scalar-name&quot;</span><span class="p">)</span>
<span class="gr">Out[217]: </span>
<span class="go">a   -0.365106</span>
<span class="go">b    1.092702</span>
<span class="go">c   -1.481449</span>
<span class="go">d    1.781190</span>
<span class="go">e   -0.031543</span>
<span class="go">Name: scalar-name, dtype: float64</span>
</pre></div>
</div>
<p id="basics-rename-axis">The Panel class has a related <a class="reference internal" href="generated/pandas.Panel.rename_axis.html#pandas.Panel.rename_axis" title="pandas.Panel.rename_axis"><code class="xref py py-meth docutils literal"><span class="pre">rename_axis()</span></code></a> class which can rename
any of its three axes.</p>
</div>
</div>
<div class="section" id="iteration">
<span id="basics-iteration"></span><h2>Iteration<a class="headerlink" href="#iteration" title="Permalink to this headline">¶</a></h2>
<p>The behavior of basic iteration over pandas objects depends on the type.
When iterating over a Series, it is regarded as array-like, and basic iteration
produces the values. Other data structures, like DataFrame and Panel,
follow the dict-like convention of iterating over the &#8220;keys&#8221; of the
objects.</p>
<p>In short, basic iteration (<code class="docutils literal"><span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">object</span></code>) produces:</p>
<ul class="simple">
<li><strong>Series</strong>: values</li>
<li><strong>DataFrame</strong>: column labels</li>
<li><strong>Panel</strong>: item labels</li>
</ul>
<p>Thus, for example, iterating over a DataFrame gives you the column names:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [218]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;col1&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;col2&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">)},</span>
<span class="gp">   .....:</span>                   <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="gp">   .....:</span> 

<span class="gp">In [219]: </span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
<span class="gp">   .....:</span>     <span class="k">print</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<span class="gp">   .....:</span> 
<span class="go">col1</span>
<span class="go">col2</span>
</pre></div>
</div>
<p>Pandas objects also have the dict-like <a class="reference internal" href="generated/pandas.DataFrame.iteritems.html#pandas.DataFrame.iteritems" title="pandas.DataFrame.iteritems"><code class="xref py py-meth docutils literal"><span class="pre">iteritems()</span></code></a> method to
iterate over the (key, value) pairs.</p>
<p>To iterate over the rows of a DataFrame, you can use the following methods:</p>
<ul class="simple">
<li><a class="reference internal" href="generated/pandas.DataFrame.iterrows.html#pandas.DataFrame.iterrows" title="pandas.DataFrame.iterrows"><code class="xref py py-meth docutils literal"><span class="pre">iterrows()</span></code></a>: Iterate over the rows of a DataFrame as (index, Series) pairs.
This converts the rows to Series objects, which can change the dtypes and has some
performance implications.</li>
<li><a class="reference internal" href="generated/pandas.DataFrame.itertuples.html#pandas.DataFrame.itertuples" title="pandas.DataFrame.itertuples"><code class="xref py py-meth docutils literal"><span class="pre">itertuples()</span></code></a>: Iterate over the rows of a DataFrame
as namedtuples of the values.  This is a lot faster than
<a class="reference internal" href="generated/pandas.DataFrame.iterrows.html#pandas.DataFrame.iterrows" title="pandas.DataFrame.iterrows"><code class="xref py py-meth docutils literal"><span class="pre">iterrows()</span></code></a>, and is in most cases preferable to use
to iterate over the values of a DataFrame.</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Iterating through pandas objects is generally <strong>slow</strong>. In many cases,
iterating manually over the rows is not needed and can be avoided with
one of the following approaches:</p>
<ul class="last simple">
<li>Look for a <em>vectorized</em> solution: many operations can be performed using
built-in methods or numpy functions, (boolean) indexing, ...</li>
<li>When you have a function that cannot work on the full DataFrame/Series
at once, it is better to use <a class="reference internal" href="generated/pandas.DataFrame.apply.html#pandas.DataFrame.apply" title="pandas.DataFrame.apply"><code class="xref py py-meth docutils literal"><span class="pre">apply()</span></code></a> instead of iterating
over the values. See the docs on <a class="reference internal" href="#basics-apply"><span class="std std-ref">function application</span></a>.</li>
<li>If you need to do iterative manipulations on the values but performance is
important, consider writing the inner loop using e.g. cython or numba.
See the <a class="reference internal" href="enhancingperf.html#enhancingperf"><span class="std std-ref">enhancing performance</span></a> section for some
examples of this approach.</li>
</ul>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>You should <strong>never modify</strong> something you are iterating over.
This is not guaranteed to work in all cases. Depending on the
data types, the iterator returns a copy and not a view, and writing
to it will have no effect!</p>
<p>For example, in the following case setting the value has no effect:</p>
<div class="last highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [220]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]})</span>

<span class="gp">In [221]: </span><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
<span class="gp">   .....:</span>     <span class="n">row</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">   .....:</span> 

<span class="gp">In [222]: </span><span class="n">df</span>
<span class="gr">Out[222]: </span>
<span class="go">   a  b</span>
<span class="go">0  1  a</span>
<span class="go">1  2  b</span>
<span class="go">2  3  c</span>
</pre></div>
</div>
</div>
<div class="section" id="iteritems">
<h3>iteritems<a class="headerlink" href="#iteritems" title="Permalink to this headline">¶</a></h3>
<p>Consistent with the dict-like interface, <a class="reference internal" href="generated/pandas.DataFrame.iteritems.html#pandas.DataFrame.iteritems" title="pandas.DataFrame.iteritems"><code class="xref py py-meth docutils literal"><span class="pre">iteritems()</span></code></a> iterates
through key-value pairs:</p>
<ul class="simple">
<li><strong>Series</strong>: (index, scalar value) pairs</li>
<li><strong>DataFrame</strong>: (column, Series) pairs</li>
<li><strong>Panel</strong>: (item, DataFrame) pairs</li>
</ul>
<p>For example:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [223]: </span><span class="k">for</span> <span class="n">item</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">wp</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
<span class="gp">   .....:</span>     <span class="k">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="gp">   .....:</span>     <span class="k">print</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="gp">   .....:</span> 
<span class="go">Item1</span>
<span class="go">                   A         B         C         D</span>
<span class="go">2000-01-01 -1.032011  0.969818 -0.962723  1.382083</span>
<span class="go">2000-01-02 -0.938794  0.669142 -0.433567 -0.273610</span>
<span class="go">2000-01-03  0.680433 -0.308450 -0.276099 -1.821168</span>
<span class="go">2000-01-04 -1.993606 -1.927385 -2.027924  1.624972</span>
<span class="go">2000-01-05  0.551135  3.059267  0.455264 -0.030740</span>
<span class="go">Item2</span>
<span class="go">                   A         B         C         D</span>
<span class="go">2000-01-01  0.935716  1.061192 -2.107852  0.199905</span>
<span class="go">2000-01-02  0.323586 -0.641630 -0.587514  0.053897</span>
<span class="go">2000-01-03  0.194889 -0.381994  0.318587  2.089075</span>
<span class="go">2000-01-04 -0.728293 -0.090255 -0.748199  1.318931</span>
<span class="go">2000-01-05 -2.029766  0.792652  0.461007 -0.542749</span>
</pre></div>
</div>
</div>
<div class="section" id="iterrows">
<span id="basics-iterrows"></span><h3>iterrows<a class="headerlink" href="#iterrows" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="generated/pandas.DataFrame.iterrows.html#pandas.DataFrame.iterrows" title="pandas.DataFrame.iterrows"><code class="xref py py-meth docutils literal"><span class="pre">iterrows()</span></code></a> allows you to iterate through the rows of a
DataFrame as Series objects. It returns an iterator yielding each
index value along with a Series containing the data in each row:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [224]: </span><span class="k">for</span> <span class="n">row_index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
<span class="gp">   .....:</span>     <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">row_index</span><span class="p">,</span> <span class="n">row</span><span class="p">))</span>
<span class="gp">   .....:</span> 
<span class="go">0</span>
<span class="go">a    1</span>
<span class="go">b    a</span>
<span class="go">Name: 0, dtype: object</span>
<span class="go">1</span>
<span class="go">a    2</span>
<span class="go">b    b</span>
<span class="go">Name: 1, dtype: object</span>
<span class="go">2</span>
<span class="go">a    3</span>
<span class="go">b    c</span>
<span class="go">Name: 2, dtype: object</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Because <a class="reference internal" href="generated/pandas.DataFrame.iterrows.html#pandas.DataFrame.iterrows" title="pandas.DataFrame.iterrows"><code class="xref py py-meth docutils literal"><span class="pre">iterrows()</span></code></a> returns a Series for each row,
it does <strong>not</strong> preserve dtypes across the rows (dtypes are
preserved across columns for DataFrames). For example,</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [225]: </span><span class="n">df_orig</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">])</span>

<span class="gp">In [226]: </span><span class="n">df_orig</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gr">Out[226]: </span>
<span class="go">int        int64</span>
<span class="go">float    float64</span>
<span class="go">dtype: object</span>

<span class="gp">In [227]: </span><span class="n">row</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">df_orig</span><span class="o">.</span><span class="n">iterrows</span><span class="p">())[</span><span class="mi">1</span><span class="p">]</span>

<span class="gp">In [228]: </span><span class="n">row</span>
<span class="gr">Out[228]: </span>
<span class="go">int      1.0</span>
<span class="go">float    1.5</span>
<span class="go">Name: 0, dtype: float64</span>
</pre></div>
</div>
<p>All values in <code class="docutils literal"><span class="pre">row</span></code>, returned as a Series, are now upcasted
to floats, also the original integer value in column <cite>x</cite>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [229]: </span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
<span class="gr">Out[229]: </span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>

<span class="gp">In [230]: </span><span class="n">df_orig</span><span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
<span class="gr">Out[230]: </span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="last">To preserve dtypes while iterating over the rows, it is better
to use <a class="reference internal" href="generated/pandas.DataFrame.itertuples.html#pandas.DataFrame.itertuples" title="pandas.DataFrame.itertuples"><code class="xref py py-meth docutils literal"><span class="pre">itertuples()</span></code></a> which returns namedtuples of the values
and which is generally much faster as <code class="docutils literal"><span class="pre">iterrows</span></code>.</p>
</div>
<p>For instance, a contrived way to transpose the DataFrame would be:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [231]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>

<span class="gp">In [232]: </span><span class="k">print</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="go">   x  y</span>
<span class="go">0  1  4</span>
<span class="go">1  2  5</span>
<span class="go">2  3  6</span>

<span class="gp">In [233]: </span><span class="k">print</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="go">   0  1  2</span>
<span class="go">x  1  2  3</span>
<span class="go">y  4  5  6</span>

<span class="gp">In [234]: </span><span class="n">df2_t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">((</span><span class="n">idx</span><span class="p">,</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">df2</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()))</span>

<span class="gp">In [235]: </span><span class="k">print</span><span class="p">(</span><span class="n">df2_t</span><span class="p">)</span>
<span class="go">   0  1  2</span>
<span class="go">x  1  2  3</span>
<span class="go">y  4  5  6</span>
</pre></div>
</div>
</div>
<div class="section" id="itertuples">
<h3>itertuples<a class="headerlink" href="#itertuples" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="generated/pandas.DataFrame.itertuples.html#pandas.DataFrame.itertuples" title="pandas.DataFrame.itertuples"><code class="xref py py-meth docutils literal"><span class="pre">itertuples()</span></code></a> method will return an iterator
yielding a namedtuple for each row in the DataFrame. The first element
of the tuple will be the row&#8217;s corresponding index value, while the
remaining values are the row values.</p>
<p>For instance,</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [236]: </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
<span class="gp">   .....:</span>     <span class="k">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
<span class="gp">   .....:</span> 
<span class="go">Pandas(Index=0, a=1, b=&#39;a&#39;)</span>
<span class="go">Pandas(Index=1, a=2, b=&#39;b&#39;)</span>
<span class="go">Pandas(Index=2, a=3, b=&#39;c&#39;)</span>
</pre></div>
</div>
<p>This method does not convert the row to a Series object but just
returns the values inside a namedtuple. Therefore,
<a class="reference internal" href="generated/pandas.DataFrame.itertuples.html#pandas.DataFrame.itertuples" title="pandas.DataFrame.itertuples"><code class="xref py py-meth docutils literal"><span class="pre">itertuples()</span></code></a> preserves the data type of the values
and is generally faster as <a class="reference internal" href="generated/pandas.DataFrame.iterrows.html#pandas.DataFrame.iterrows" title="pandas.DataFrame.iterrows"><code class="xref py py-meth docutils literal"><span class="pre">iterrows()</span></code></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The column names will be renamed to positional names if they are
invalid Python identifiers, repeated, or start with an underscore.
With a large number of columns (&gt;255), regular tuples are returned.</p>
</div>
</div>
</div>
<div class="section" id="dt-accessor">
<span id="basics-dt-accessors"></span><h2>.dt accessor<a class="headerlink" href="#dt-accessor" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">Series</span></code> has an accessor to succinctly return datetime like properties for the
<em>values</em> of the Series, if it is a datetime/period like Series.
This will return a Series, indexed like the existing Series.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="c"># datetime</span>
<span class="gp">In [237]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;20130101 09:10:12&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>

<span class="gp">In [238]: </span><span class="n">s</span>
<span class="gr">Out[238]: </span>
<span class="go">0   2013-01-01 09:10:12</span>
<span class="go">1   2013-01-02 09:10:12</span>
<span class="go">2   2013-01-03 09:10:12</span>
<span class="go">3   2013-01-04 09:10:12</span>
<span class="go">dtype: datetime64[ns]</span>

<span class="gp">In [239]: </span><span class="n">s</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span>
<span class="gr">Out[239]: </span>
<span class="go">0    9</span>
<span class="go">1    9</span>
<span class="go">2    9</span>
<span class="go">3    9</span>
<span class="go">dtype: int64</span>

<span class="gp">In [240]: </span><span class="n">s</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">second</span>
<span class="gr">Out[240]: </span>
<span class="go">0    12</span>
<span class="go">1    12</span>
<span class="go">2    12</span>
<span class="go">3    12</span>
<span class="go">dtype: int64</span>

<span class="gp">In [241]: </span><span class="n">s</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span>
<span class="gr">Out[241]: </span>
<span class="go">0    1</span>
<span class="go">1    2</span>
<span class="go">2    3</span>
<span class="go">3    4</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
<p>This enables nice expressions like this:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [242]: </span><span class="n">s</span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
<span class="gr">Out[242]: </span>
<span class="go">1   2013-01-02 09:10:12</span>
<span class="go">dtype: datetime64[ns]</span>
</pre></div>
</div>
<p>You can easily produces tz aware transformations:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [243]: </span><span class="n">stz</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="s1">&#39;US/Eastern&#39;</span><span class="p">)</span>

<span class="gp">In [244]: </span><span class="n">stz</span>
<span class="gr">Out[244]: </span>
<span class="go">0   2013-01-01 09:10:12-05:00</span>
<span class="go">1   2013-01-02 09:10:12-05:00</span>
<span class="go">2   2013-01-03 09:10:12-05:00</span>
<span class="go">3   2013-01-04 09:10:12-05:00</span>
<span class="go">dtype: datetime64[ns, US/Eastern]</span>

<span class="gp">In [245]: </span><span class="n">stz</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">tz</span>
<span class="gr">Out[245]: </span><span class="o">&lt;</span><span class="n">DstTzInfo</span> <span class="s1">&#39;US/Eastern&#39;</span> <span class="n">LMT</span><span class="o">-</span><span class="mi">1</span> <span class="n">day</span><span class="p">,</span> <span class="mi">19</span><span class="p">:</span><span class="mo">04</span><span class="p">:</span><span class="mo">00</span> <span class="n">STD</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>You can also chain these types of operations:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [246]: </span><span class="n">s</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="s1">&#39;UTC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="s1">&#39;US/Eastern&#39;</span><span class="p">)</span>
<span class="gr">Out[246]: </span>
<span class="go">0   2013-01-01 04:10:12-05:00</span>
<span class="go">1   2013-01-02 04:10:12-05:00</span>
<span class="go">2   2013-01-03 04:10:12-05:00</span>
<span class="go">3   2013-01-04 04:10:12-05:00</span>
<span class="go">dtype: datetime64[ns, US/Eastern]</span>
</pre></div>
</div>
<p>You can also format datetime values as strings with <a class="reference internal" href="generated/pandas.Series.dt.strftime.html#pandas.Series.dt.strftime" title="pandas.Series.dt.strftime"><code class="xref py py-meth docutils literal"><span class="pre">Series.dt.strftime()</span></code></a> which
supports the same format as the standard <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime.strftime" title="(in Python v3.6)"><code class="xref py py-meth docutils literal"><span class="pre">strftime()</span></code></a>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="c"># DatetimeIndex</span>
<span class="gp">In [247]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;20130101&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>

<span class="gp">In [248]: </span><span class="n">s</span>
<span class="gr">Out[248]: </span>
<span class="go">0   2013-01-01</span>
<span class="go">1   2013-01-02</span>
<span class="go">2   2013-01-03</span>
<span class="go">3   2013-01-04</span>
<span class="go">dtype: datetime64[ns]</span>

<span class="gp">In [249]: </span><span class="n">s</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y/%m/</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gr">Out[249]: </span>
<span class="go">0    2013/01/01</span>
<span class="go">1    2013/01/02</span>
<span class="go">2    2013/01/03</span>
<span class="go">3    2013/01/04</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="c"># PeriodIndex</span>
<span class="gp">In [250]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">period_range</span><span class="p">(</span><span class="s1">&#39;20130101&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>

<span class="gp">In [251]: </span><span class="n">s</span>
<span class="gr">Out[251]: </span>
<span class="go">0   2013-01-01</span>
<span class="go">1   2013-01-02</span>
<span class="go">2   2013-01-03</span>
<span class="go">3   2013-01-04</span>
<span class="go">dtype: object</span>

<span class="gp">In [252]: </span><span class="n">s</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y/%m/</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gr">Out[252]: </span>
<span class="go">0    2013/01/01</span>
<span class="go">1    2013/01/02</span>
<span class="go">2    2013/01/03</span>
<span class="go">3    2013/01/04</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">.dt</span></code> accessor works for period and timedelta dtypes.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="c"># period</span>
<span class="gp">In [253]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">period_range</span><span class="p">(</span><span class="s1">&#39;20130101&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">))</span>

<span class="gp">In [254]: </span><span class="n">s</span>
<span class="gr">Out[254]: </span>
<span class="go">0   2013-01-01</span>
<span class="go">1   2013-01-02</span>
<span class="go">2   2013-01-03</span>
<span class="go">3   2013-01-04</span>
<span class="go">dtype: object</span>

<span class="gp">In [255]: </span><span class="n">s</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
<span class="gr">Out[255]: </span>
<span class="go">0    2013</span>
<span class="go">1    2013</span>
<span class="go">2    2013</span>
<span class="go">3    2013</span>
<span class="go">dtype: int64</span>

<span class="gp">In [256]: </span><span class="n">s</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span>
<span class="gr">Out[256]: </span>
<span class="go">0    1</span>
<span class="go">1    2</span>
<span class="go">2    3</span>
<span class="go">3    4</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="c"># timedelta</span>
<span class="gp">In [257]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">timedelta_range</span><span class="p">(</span><span class="s1">&#39;1 day 00:00:05&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">))</span>

<span class="gp">In [258]: </span><span class="n">s</span>
<span class="gr">Out[258]: </span>
<span class="go">0   1 days 00:00:05</span>
<span class="go">1   1 days 00:00:06</span>
<span class="go">2   1 days 00:00:07</span>
<span class="go">3   1 days 00:00:08</span>
<span class="go">dtype: timedelta64[ns]</span>

<span class="gp">In [259]: </span><span class="n">s</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span>
<span class="gr">Out[259]: </span>
<span class="go">0    1</span>
<span class="go">1    1</span>
<span class="go">2    1</span>
<span class="go">3    1</span>
<span class="go">dtype: int64</span>

<span class="gp">In [260]: </span><span class="n">s</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">seconds</span>
<span class="gr">Out[260]: </span>
<span class="go">0    5</span>
<span class="go">1    6</span>
<span class="go">2    7</span>
<span class="go">3    8</span>
<span class="go">dtype: int64</span>

<span class="gp">In [261]: </span><span class="n">s</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">components</span>
<span class="gr">Out[261]: </span>
<span class="go">   days  hours  minutes  seconds  milliseconds  microseconds  nanoseconds</span>
<span class="go">0     1      0        0        5             0             0            0</span>
<span class="go">1     1      0        0        6             0             0            0</span>
<span class="go">2     1      0        0        7             0             0            0</span>
<span class="go">3     1      0        0        8             0             0            0</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">Series.dt</span></code> will raise a <code class="docutils literal"><span class="pre">TypeError</span></code> if you access with a non-datetimelike values</p>
</div>
</div>
<div class="section" id="vectorized-string-methods">
<h2>Vectorized string methods<a class="headerlink" href="#vectorized-string-methods" title="Permalink to this headline">¶</a></h2>
<p>Series is equipped with a set of string processing methods that make it easy to
operate on each element of the array. Perhaps most importantly, these methods
exclude missing/NA values automatically. These are accessed via the Series&#8217;s
<code class="docutils literal"><span class="pre">str</span></code> attribute and generally have names matching the equivalent (scalar)
built-in string methods. For example:</p>
<blockquote>
<div><div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [262]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;Aaba&#39;</span><span class="p">,</span> <span class="s1">&#39;Baca&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;CABA&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">])</span>

<span class="gp">In [263]: </span><span class="n">s</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="gr">Out[263]: </span>
<span class="go">0       a</span>
<span class="go">1       b</span>
<span class="go">2       c</span>
<span class="go">3    aaba</span>
<span class="go">4    baca</span>
<span class="go">5     NaN</span>
<span class="go">6    caba</span>
<span class="go">7     dog</span>
<span class="go">8     cat</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
</div></blockquote>
<p>Powerful pattern-matching methods are provided as well, but note that
pattern-matching generally uses <a class="reference external" href="https://docs.python.org/2/library/re.html">regular expressions</a> by default (and in some cases
always uses them).</p>
<p>Please see <a class="reference internal" href="text.html#text-string-methods"><span class="std std-ref">Vectorized String Methods</span></a> for a complete
description.</p>
</div>
<div class="section" id="sorting">
<span id="basics-sorting"></span><h2>Sorting<a class="headerlink" href="#sorting" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The sorting API is substantially changed in 0.17.0, see <a class="reference internal" href="whatsnew.html#whatsnew-0170-api-breaking-sorting"><span class="std std-ref">here</span></a> for these changes.
In particular, all sorting methods now return a new object by default, and <strong>DO NOT</strong> operate in-place (except by passing <code class="docutils literal"><span class="pre">inplace=True</span></code>).</p>
</div>
<p>There are two obvious kinds of sorting that you may be interested in: sorting
by label and sorting by actual values.</p>
<div class="section" id="by-index">
<h3>By Index<a class="headerlink" href="#by-index" title="Permalink to this headline">¶</a></h3>
<p>The primary method for sorting axis
labels (indexes) are the <code class="docutils literal"><span class="pre">Series.sort_index()</span></code> and the <code class="docutils literal"><span class="pre">DataFrame.sort_index()</span></code> methods.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [264]: </span><span class="n">unsorted_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span>
<span class="gp">   .....:</span>                          <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">])</span>
<span class="gp">   .....:</span> 

<span class="c"># DataFrame</span>
<span class="gp">In [265]: </span><span class="n">unsorted_df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="gr">Out[265]: </span>
<span class="go">   three  two  one</span>
<span class="go">a    NaN  NaN  NaN</span>
<span class="go">b    NaN  NaN  NaN</span>
<span class="go">c    NaN  NaN  NaN</span>
<span class="go">d    NaN  NaN  NaN</span>

<span class="gp">In [266]: </span><span class="n">unsorted_df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gr">Out[266]: </span>
<span class="go">   three  two  one</span>
<span class="go">d    NaN  NaN  NaN</span>
<span class="go">c    NaN  NaN  NaN</span>
<span class="go">b    NaN  NaN  NaN</span>
<span class="go">a    NaN  NaN  NaN</span>

<span class="gp">In [267]: </span><span class="n">unsorted_df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gr">Out[267]: </span>
<span class="go">   one  three  two</span>
<span class="go">a  NaN    NaN  NaN</span>
<span class="go">d  NaN    NaN  NaN</span>
<span class="go">c  NaN    NaN  NaN</span>
<span class="go">b  NaN    NaN  NaN</span>

<span class="c"># Series</span>
<span class="gp">In [268]: </span><span class="n">unsorted_df</span><span class="p">[</span><span class="s1">&#39;three&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="gr">Out[268]: </span>
<span class="go">a   NaN</span>
<span class="go">b   NaN</span>
<span class="go">c   NaN</span>
<span class="go">d   NaN</span>
<span class="go">Name: three, dtype: float64</span>
</pre></div>
</div>
</div>
<div class="section" id="by-values">
<h3>By Values<a class="headerlink" href="#by-values" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="generated/pandas.Series.sort_values.html#pandas.Series.sort_values" title="pandas.Series.sort_values"><code class="xref py py-meth docutils literal"><span class="pre">Series.sort_values()</span></code></a> and <a class="reference internal" href="generated/pandas.DataFrame.sort_values.html#pandas.DataFrame.sort_values" title="pandas.DataFrame.sort_values"><code class="xref py py-meth docutils literal"><span class="pre">DataFrame.sort_values()</span></code></a> are the entry points for <strong>value</strong> sorting (that is the values in a column or row).
<a class="reference internal" href="generated/pandas.DataFrame.sort_values.html#pandas.DataFrame.sort_values" title="pandas.DataFrame.sort_values"><code class="xref py py-meth docutils literal"><span class="pre">DataFrame.sort_values()</span></code></a> can accept an optional <code class="docutils literal"><span class="pre">by</span></code> argument for <code class="docutils literal"><span class="pre">axis=0</span></code>
which will use an arbitrary vector or a column name of the DataFrame to
determine the sort order:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [269]: </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;one&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;two&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="s1">&#39;three&#39;</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]})</span>

<span class="gp">In [270]: </span><span class="n">df1</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;two&#39;</span><span class="p">)</span>
<span class="gr">Out[270]: </span>
<span class="go">   one  three  two</span>
<span class="go">0    2      5    1</span>
<span class="go">2    1      3    2</span>
<span class="go">1    1      4    3</span>
<span class="go">3    1      2    4</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">by</span></code> argument can take a list of column names, e.g.:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [271]: </span><span class="n">df1</span><span class="p">[[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span><span class="s1">&#39;two&#39;</span><span class="p">])</span>
<span class="gr">Out[271]: </span>
<span class="go">   one  two  three</span>
<span class="go">2    1    2      3</span>
<span class="go">1    1    3      4</span>
<span class="go">3    1    4      2</span>
<span class="go">0    2    1      5</span>
</pre></div>
</div>
<p>These methods have special treatment of NA values via the <code class="docutils literal"><span class="pre">na_position</span></code>
argument:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [272]: </span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="gp">In [273]: </span><span class="n">s</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
<span class="gr">Out[273]: </span>
<span class="go">0       A</span>
<span class="go">3    Aaba</span>
<span class="go">1       B</span>
<span class="go">4    Baca</span>
<span class="go">6    CABA</span>
<span class="go">8     cat</span>
<span class="go">7     dog</span>
<span class="go">2     NaN</span>
<span class="go">5     NaN</span>
<span class="go">dtype: object</span>

<span class="gp">In [274]: </span><span class="n">s</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">na_position</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
<span class="gr">Out[274]: </span>
<span class="go">2     NaN</span>
<span class="go">5     NaN</span>
<span class="go">0       A</span>
<span class="go">3    Aaba</span>
<span class="go">1       B</span>
<span class="go">4    Baca</span>
<span class="go">6    CABA</span>
<span class="go">8     cat</span>
<span class="go">7     dog</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
</div>
<div class="section" id="searchsorted">
<span id="basics-searchsorted"></span><h3>searchsorted<a class="headerlink" href="#searchsorted" title="Permalink to this headline">¶</a></h3>
<p>Series has the <a class="reference internal" href="generated/pandas.Series.searchsorted.html#pandas.Series.searchsorted" title="pandas.Series.searchsorted"><code class="xref py py-meth docutils literal"><span class="pre">searchsorted()</span></code></a> method, which works similar to
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.searchsorted.html#numpy.ndarray.searchsorted" title="(in NumPy v1.11)"><code class="xref py py-meth docutils literal"><span class="pre">numpy.ndarray.searchsorted()</span></code></a>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [275]: </span><span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="gp">In [276]: </span><span class="n">ser</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gr">Out[276]: </span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="gp">In [277]: </span><span class="n">ser</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gr">Out[277]: </span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="gp">In [278]: </span><span class="n">ser</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="gr">Out[278]: </span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="gp">In [279]: </span><span class="n">ser</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="gr">Out[279]: </span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="gp">In [280]: </span><span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="gp">In [281]: </span><span class="n">ser</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">sorter</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">ser</span><span class="p">))</span>
<span class="gr">Out[281]: </span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="smallest-largest-values">
<span id="basics-nsorted"></span><h3>smallest / largest values<a class="headerlink" href="#smallest-largest-values" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.14.0.</span></p>
</div>
<p><code class="docutils literal"><span class="pre">Series</span></code> has the <a class="reference internal" href="generated/pandas.Series.nsmallest.html#pandas.Series.nsmallest" title="pandas.Series.nsmallest"><code class="xref py py-meth docutils literal"><span class="pre">nsmallest()</span></code></a> and <a class="reference internal" href="generated/pandas.Series.nlargest.html#pandas.Series.nlargest" title="pandas.Series.nlargest"><code class="xref py py-meth docutils literal"><span class="pre">nlargest()</span></code></a> methods which return the
smallest or largest <span class="math">n</span> values. For a large <code class="docutils literal"><span class="pre">Series</span></code> this can be much
faster than sorting the entire Series and calling <code class="docutils literal"><span class="pre">head(n)</span></code> on the result.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [282]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

<span class="gp">In [283]: </span><span class="n">s</span>
<span class="gr">Out[283]: </span>
<span class="go">0    9</span>
<span class="go">1    8</span>
<span class="go">2    5</span>
<span class="go">3    3</span>
<span class="go">4    6</span>
<span class="go">5    7</span>
<span class="go">6    0</span>
<span class="go">7    2</span>
<span class="go">8    4</span>
<span class="go">9    1</span>
<span class="go">dtype: int64</span>

<span class="gp">In [284]: </span><span class="n">s</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
<span class="gr">Out[284]: </span>
<span class="go">6    0</span>
<span class="go">9    1</span>
<span class="go">7    2</span>
<span class="go">3    3</span>
<span class="go">8    4</span>
<span class="go">2    5</span>
<span class="go">4    6</span>
<span class="go">5    7</span>
<span class="go">1    8</span>
<span class="go">0    9</span>
<span class="go">dtype: int64</span>

<span class="gp">In [285]: </span><span class="n">s</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gr">Out[285]: </span>
<span class="go">6    0</span>
<span class="go">9    1</span>
<span class="go">7    2</span>
<span class="go">dtype: int64</span>

<span class="gp">In [286]: </span><span class="n">s</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gr">Out[286]: </span>
<span class="go">0    9</span>
<span class="go">1    8</span>
<span class="go">5    7</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.17.0.</span></p>
</div>
<p><code class="docutils literal"><span class="pre">DataFrame</span></code> also has the <code class="docutils literal"><span class="pre">nlargest</span></code> and <code class="docutils literal"><span class="pre">nsmallest</span></code> methods.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [287]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">   .....:</span>                    <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abdceff&#39;</span><span class="p">),</span>
<span class="gp">   .....:</span>                    <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]})</span>
<span class="gp">   .....:</span> 

<span class="gp">In [288]: </span><span class="n">df</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gr">Out[288]: </span>
<span class="go">    a  b    c</span>
<span class="go">5  11  f  3.0</span>
<span class="go">3  10  c  3.2</span>
<span class="go">4   8  e  NaN</span>

<span class="gp">In [289]: </span><span class="n">df</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="gr">Out[289]: </span>
<span class="go">    a  b    c</span>
<span class="go">5  11  f  3.0</span>
<span class="go">3  10  c  3.2</span>
<span class="go">4   8  e  NaN</span>
<span class="go">2   1  d  4.0</span>
<span class="go">1  -1  b  2.0</span>
<span class="go">6  -1  f  4.0</span>

<span class="gp">In [290]: </span><span class="n">df</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gr">Out[290]: </span>
<span class="go">   a  b    c</span>
<span class="go">0 -2  a  1.0</span>
<span class="go">1 -1  b  2.0</span>
<span class="go">6 -1  f  4.0</span>
<span class="go">1 -1  b  2.0</span>
<span class="go">6 -1  f  4.0</span>

<span class="gp">In [291]: </span><span class="n">df</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="gr">Out[291]: </span>
<span class="go">   a  b    c</span>
<span class="go">0 -2  a  1.0</span>
<span class="go">1 -1  b  2.0</span>
<span class="go">6 -1  f  4.0</span>
<span class="go">1 -1  b  2.0</span>
<span class="go">6 -1  f  4.0</span>
<span class="go">2  1  d  4.0</span>
<span class="go">4  8  e  NaN</span>
</pre></div>
</div>
</div>
<div class="section" id="sorting-by-a-multi-index-column">
<span id="basics-multi-index-sorting"></span><h3>Sorting by a multi-index column<a class="headerlink" href="#sorting-by-a-multi-index-column" title="Permalink to this headline">¶</a></h3>
<p>You must be explicit about sorting when the column is a multi-index, and fully specify
all levels to <code class="docutils literal"><span class="pre">by</span></code>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [292]: </span><span class="n">df1</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;one&#39;</span><span class="p">),(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;two&#39;</span><span class="p">),(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;three&#39;</span><span class="p">)])</span>

<span class="gp">In [293]: </span><span class="n">df1</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;two&#39;</span><span class="p">))</span>
<span class="gr">Out[293]: </span>
<span class="go">    a         b</span>
<span class="go">  one two three</span>
<span class="go">3   1   2     4</span>
<span class="go">2   1   3     2</span>
<span class="go">1   1   4     3</span>
<span class="go">0   2   5     1</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="copying">
<h2>Copying<a class="headerlink" href="#copying" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="generated/pandas.DataFrame.copy.html#pandas.DataFrame.copy" title="pandas.DataFrame.copy"><code class="xref py py-meth docutils literal"><span class="pre">copy()</span></code></a> method on pandas objects copies the underlying data (though not
the axis indexes, since they are immutable) and returns a new object. Note that
<strong>it is seldom necessary to copy objects</strong>. For example, there are only a
handful of ways to alter a DataFrame <em>in-place</em>:</p>
<blockquote>
<div><ul class="simple">
<li>Inserting, deleting, or modifying a column</li>
<li>Assigning to the <code class="docutils literal"><span class="pre">index</span></code> or <code class="docutils literal"><span class="pre">columns</span></code> attributes</li>
<li>For homogeneous data, directly modifying the values via the <code class="docutils literal"><span class="pre">values</span></code>
attribute or advanced indexing</li>
</ul>
</div></blockquote>
<p>To be clear, no pandas methods have the side effect of modifying your data;
almost all methods return new objects, leaving the original object
untouched. If data is modified, it is because you did so explicitly.</p>
</div>
<div class="section" id="dtypes">
<span id="basics-dtypes"></span><h2>dtypes<a class="headerlink" href="#dtypes" title="Permalink to this headline">¶</a></h2>
<p>The main types stored in pandas objects are <code class="docutils literal"><span class="pre">float</span></code>, <code class="docutils literal"><span class="pre">int</span></code>, <code class="docutils literal"><span class="pre">bool</span></code>,
<code class="docutils literal"><span class="pre">datetime64[ns]</span></code> and <code class="docutils literal"><span class="pre">datetime64[ns,</span> <span class="pre">tz]</span></code> (in &gt;= 0.17.0), <code class="docutils literal"><span class="pre">timedelta[ns]</span></code>, <code class="docutils literal"><span class="pre">category</span></code> (in &gt;= 0.15.0), and <code class="docutils literal"><span class="pre">object</span></code>. In addition these dtypes
have item sizes, e.g. <code class="docutils literal"><span class="pre">int64</span></code> and <code class="docutils literal"><span class="pre">int32</span></code>. See <a class="reference internal" href="timeseries.html#timeseries-timezone-series"><span class="std std-ref">Series with TZ</span></a> for more detail on <code class="docutils literal"><span class="pre">datetime64[ns,</span> <span class="pre">tz]</span></code> dtypes.</p>
<p>A convenient <a class="reference internal" href="generated/pandas.DataFrame.dtypes.html#pandas.DataFrame.dtypes" title="pandas.DataFrame.dtypes"><code class="xref py py-attr docutils literal"><span class="pre">dtypes</span></code></a> attribute for DataFrames returns a Series with the data type of each column.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [294]: </span><span class="n">dft</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
<span class="gp">   .....:</span>                         <span class="n">B</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">   .....:</span>                         <span class="n">C</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
<span class="gp">   .....:</span>                         <span class="n">D</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;20010102&#39;</span><span class="p">),</span>
<span class="gp">   .....:</span>                         <span class="n">E</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">1.0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">),</span>
<span class="gp">   .....:</span>                                     <span class="n">F</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
<span class="gp">   .....:</span>                                     <span class="n">G</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int8&#39;</span><span class="p">)))</span>
<span class="gp">   .....:</span> 

<span class="gp">In [295]: </span><span class="n">dft</span>
<span class="gr">Out[295]: </span>
<span class="go">          A  B    C          D    E      F  G</span>
<span class="go">0  0.954940  1  foo 2001-01-02  1.0  False  1</span>
<span class="go">1  0.318163  1  foo 2001-01-02  1.0  False  1</span>
<span class="go">2  0.985803  1  foo 2001-01-02  1.0  False  1</span>

<span class="gp">In [296]: </span><span class="n">dft</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gr">Out[296]: </span>
<span class="go">A           float64</span>
<span class="go">B             int64</span>
<span class="go">C            object</span>
<span class="go">D    datetime64[ns]</span>
<span class="go">E           float32</span>
<span class="go">F              bool</span>
<span class="go">G              int8</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>On a <code class="docutils literal"><span class="pre">Series</span></code> use the <a class="reference internal" href="generated/pandas.Series.dtype.html#pandas.Series.dtype" title="pandas.Series.dtype"><code class="xref py py-attr docutils literal"><span class="pre">dtype</span></code></a> attribute.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [297]: </span><span class="n">dft</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
<span class="gr">Out[297]: </span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If a pandas object contains data multiple dtypes <em>IN A SINGLE COLUMN</em>, the dtype of the
column will be chosen to accommodate all of the data types (<code class="docutils literal"><span class="pre">object</span></code> is the most
general).</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="c"># these ints are coerced to floats</span>
<span class="gp">In [298]: </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">6.</span><span class="p">])</span>
<span class="gr">Out[298]: </span>
<span class="go">0    1.0</span>
<span class="go">1    2.0</span>
<span class="go">2    3.0</span>
<span class="go">3    4.0</span>
<span class="go">4    5.0</span>
<span class="go">5    6.0</span>
<span class="go">dtype: float64</span>

<span class="c"># string data forces an ``object`` dtype</span>
<span class="gp">In [299]: </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">])</span>
<span class="gr">Out[299]: </span>
<span class="go">0      1</span>
<span class="go">1      2</span>
<span class="go">2      3</span>
<span class="go">3      6</span>
<span class="go">4    foo</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>The method <a class="reference internal" href="generated/pandas.DataFrame.get_dtype_counts.html#pandas.DataFrame.get_dtype_counts" title="pandas.DataFrame.get_dtype_counts"><code class="xref py py-meth docutils literal"><span class="pre">get_dtype_counts()</span></code></a> will return the number of columns of
each type in a <code class="docutils literal"><span class="pre">DataFrame</span></code>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [300]: </span><span class="n">dft</span><span class="o">.</span><span class="n">get_dtype_counts</span><span class="p">()</span>
<span class="gr">Out[300]: </span>
<span class="go">bool              1</span>
<span class="go">datetime64[ns]    1</span>
<span class="go">float32           1</span>
<span class="go">float64           1</span>
<span class="go">int64             1</span>
<span class="go">int8              1</span>
<span class="go">object            1</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
<p>Numeric dtypes will propagate and can coexist in DataFrames (starting in v0.11.0).
If a dtype is passed (either directly via the <code class="docutils literal"><span class="pre">dtype</span></code> keyword, a passed <code class="docutils literal"><span class="pre">ndarray</span></code>,
or a passed <code class="docutils literal"><span class="pre">Series</span></code>, then it will be preserved in DataFrame operations. Furthermore,
different numeric dtypes will <strong>NOT</strong> be combined. The following example will give you a taste.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [301]: </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>

<span class="gp">In [302]: </span><span class="n">df1</span>
<span class="gr">Out[302]: </span>
<span class="go">          A</span>
<span class="go">0  0.647650</span>
<span class="go">1  0.822993</span>
<span class="go">2  1.778703</span>
<span class="go">3 -1.543048</span>
<span class="go">4 -0.123256</span>
<span class="go">5  2.239740</span>
<span class="go">6 -0.143778</span>
<span class="go">7 -2.885090</span>

<span class="gp">In [303]: </span><span class="n">df1</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gr">Out[303]: </span>
<span class="go">A    float32</span>
<span class="go">dtype: object</span>

<span class="gp">In [304]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span> <span class="n">A</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float16&#39;</span><span class="p">),</span>
<span class="gp">   .....:</span>                         <span class="n">B</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">)),</span>
<span class="gp">   .....:</span>                         <span class="n">C</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">))</span> <span class="p">))</span>
<span class="gp">   .....:</span> 

<span class="gp">In [305]: </span><span class="n">df2</span>
<span class="gr">Out[305]: </span>
<span class="go">          A         B    C</span>
<span class="go">0  0.027588  0.296947    0</span>
<span class="go">1 -1.150391  0.007045  255</span>
<span class="go">2  0.246460  0.707877    1</span>
<span class="go">3 -0.455078  0.950661    0</span>
<span class="go">4 -1.507812  0.087527    0</span>
<span class="go">5 -0.502441 -0.339212    0</span>
<span class="go">6  0.528809 -0.278698    0</span>
<span class="go">7  0.590332  1.775379    0</span>

<span class="gp">In [306]: </span><span class="n">df2</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gr">Out[306]: </span>
<span class="go">A    float16</span>
<span class="go">B    float64</span>
<span class="go">C      uint8</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<div class="section" id="defaults">
<h3>defaults<a class="headerlink" href="#defaults" title="Permalink to this headline">¶</a></h3>
<p>By default integer types are <code class="docutils literal"><span class="pre">int64</span></code> and float types are <code class="docutils literal"><span class="pre">float64</span></code>,
<em>REGARDLESS</em> of platform (32-bit or 64-bit). The following will all result in <code class="docutils literal"><span class="pre">int64</span></code> dtypes.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [307]: </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gr">Out[307]: </span>
<span class="go">a    int64</span>
<span class="go">dtype: object</span>

<span class="gp">In [308]: </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gr">Out[308]: </span>
<span class="go">a    int64</span>
<span class="go">dtype: object</span>

<span class="gp">In [309]: </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gr">Out[309]: </span>
<span class="go">a    int64</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>Numpy, however will choose <em>platform-dependent</em> types when creating arrays.
The following <strong>WILL</strong> result in <code class="docutils literal"><span class="pre">int32</span></code> on 32-bit platform.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [310]: </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="section" id="upcasting">
<h3>upcasting<a class="headerlink" href="#upcasting" title="Permalink to this headline">¶</a></h3>
<p>Types can potentially be <em>upcasted</em> when combined with other types, meaning they are promoted
from the current type (say <code class="docutils literal"><span class="pre">int</span></code> to <code class="docutils literal"><span class="pre">float</span></code>)</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [311]: </span><span class="n">df3</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">reindex_like</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">+</span> <span class="n">df2</span>

<span class="gp">In [312]: </span><span class="n">df3</span>
<span class="gr">Out[312]: </span>
<span class="go">          A         B      C</span>
<span class="go">0  0.675238  0.296947    0.0</span>
<span class="go">1 -0.327398  0.007045  255.0</span>
<span class="go">2  2.025163  0.707877    1.0</span>
<span class="go">3 -1.998126  0.950661    0.0</span>
<span class="go">4 -1.631068  0.087527    0.0</span>
<span class="go">5  1.737299 -0.339212    0.0</span>
<span class="go">6  0.385030 -0.278698    0.0</span>
<span class="go">7 -2.294758  1.775379    0.0</span>

<span class="gp">In [313]: </span><span class="n">df3</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gr">Out[313]: </span>
<span class="go">A    float32</span>
<span class="go">B    float64</span>
<span class="go">C    float64</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">values</span></code> attribute on a DataFrame return the <em>lower-common-denominator</em> of the dtypes, meaning
the dtype that can accommodate <strong>ALL</strong> of the types in the resulting homogeneous dtyped numpy array. This can
force some <em>upcasting</em>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [314]: </span><span class="n">df3</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">dtype</span>
<span class="gr">Out[314]: </span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="astype">
<h3>astype<a class="headerlink" href="#astype" title="Permalink to this headline">¶</a></h3>
<p id="basics-cast">You can use the <a class="reference internal" href="generated/pandas.DataFrame.astype.html#pandas.DataFrame.astype" title="pandas.DataFrame.astype"><code class="xref py py-meth docutils literal"><span class="pre">astype()</span></code></a> method to explicitly convert dtypes from one to another. These will by default return a copy,
even if the dtype was unchanged (pass <code class="docutils literal"><span class="pre">copy=False</span></code> to change this behavior). In addition, they will raise an
exception if the astype operation is invalid.</p>
<p>Upcasting is always according to the <strong>numpy</strong> rules. If two different dtypes are involved in an operation,
then the more <em>general</em> one will be used as the result of the operation.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [315]: </span><span class="n">df3</span>
<span class="gr">Out[315]: </span>
<span class="go">          A         B      C</span>
<span class="go">0  0.675238  0.296947    0.0</span>
<span class="go">1 -0.327398  0.007045  255.0</span>
<span class="go">2  2.025163  0.707877    1.0</span>
<span class="go">3 -1.998126  0.950661    0.0</span>
<span class="go">4 -1.631068  0.087527    0.0</span>
<span class="go">5  1.737299 -0.339212    0.0</span>
<span class="go">6  0.385030 -0.278698    0.0</span>
<span class="go">7 -2.294758  1.775379    0.0</span>

<span class="gp">In [316]: </span><span class="n">df3</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gr">Out[316]: </span>
<span class="go">A    float32</span>
<span class="go">B    float64</span>
<span class="go">C    float64</span>
<span class="go">dtype: object</span>

<span class="c"># conversion of dtypes</span>
<span class="gp">In [317]: </span><span class="n">df3</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gr">Out[317]: </span>
<span class="go">A    float32</span>
<span class="go">B    float32</span>
<span class="go">C    float32</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>Convert a subset of columns to a specified type using <a class="reference internal" href="generated/pandas.DataFrame.astype.html#pandas.DataFrame.astype" title="pandas.DataFrame.astype"><code class="xref py py-meth docutils literal"><span class="pre">astype()</span></code></a></p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [318]: </span><span class="n">dft</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]})</span>

<span class="gp">In [319]: </span><span class="n">dft</span><span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dft</span><span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="gp">In [320]: </span><span class="n">dft</span>
<span class="gr">Out[320]: </span>
<span class="go">   a  b  c</span>
<span class="go">0  1  4  7</span>
<span class="go">1  2  5  8</span>
<span class="go">2  3  6  9</span>

<span class="gp">In [321]: </span><span class="n">dft</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gr">Out[321]: </span>
<span class="go">a    uint8</span>
<span class="go">b    uint8</span>
<span class="go">c    int64</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>When trying to convert a subset of columns to a specified type using <a class="reference internal" href="generated/pandas.DataFrame.astype.html#pandas.DataFrame.astype" title="pandas.DataFrame.astype"><code class="xref py py-meth docutils literal"><span class="pre">astype()</span></code></a>  and <a class="reference internal" href="generated/pandas.DataFrame.loc.html#pandas.DataFrame.loc" title="pandas.DataFrame.loc"><code class="xref py py-meth docutils literal"><span class="pre">loc()</span></code></a>, upcasting occurs.</p>
<p><a class="reference internal" href="generated/pandas.DataFrame.loc.html#pandas.DataFrame.loc" title="pandas.DataFrame.loc"><code class="xref py py-meth docutils literal"><span class="pre">loc()</span></code></a> tries to fit in what we are assigning to the current dtypes, while <code class="docutils literal"><span class="pre">[]</span></code> will overwrite them taking the dtype from the right hand side. Therefore the following piece of code produces the unintended result.</p>
<div class="last highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [322]: </span><span class="n">dft</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]})</span>

<span class="gp">In [323]: </span><span class="n">dft</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gr">Out[323]: </span>
<span class="go">a    uint8</span>
<span class="go">b    uint8</span>
<span class="go">dtype: object</span>

<span class="gp">In [324]: </span><span class="n">dft</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="gp">In [325]: </span><span class="n">dft</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gr">Out[325]: </span>
<span class="go">a    int64</span>
<span class="go">b    int64</span>
<span class="go">c    int64</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="object-conversion">
<span id="basics-object-conversion"></span><h3>object conversion<a class="headerlink" href="#object-conversion" title="Permalink to this headline">¶</a></h3>
<p>pandas offers various functions to try to force conversion of types from the <code class="docutils literal"><span class="pre">object</span></code> dtype to other types.
The following functions are available for one dimensional object arrays or scalars:</p>
<ul>
<li><p class="first"><a class="reference internal" href="generated/pandas.to_numeric.html#pandas.to_numeric" title="pandas.to_numeric"><code class="xref py py-meth docutils literal"><span class="pre">to_numeric()</span></code></a> (conversion to numeric dtypes)</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [326]: </span><span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1.1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="gp">In [327]: </span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="gr">Out[327]: </span><span class="n">array</span><span class="p">([</span> <span class="mf">1.1</span><span class="p">,</span>  <span class="mf">2.</span> <span class="p">,</span>  <span class="mf">3.</span> <span class="p">])</span>
</pre></div>
</div>
</li>
<li><p class="first"><a class="reference internal" href="generated/pandas.to_datetime.html#pandas.to_datetime" title="pandas.to_datetime"><code class="xref py py-meth docutils literal"><span class="pre">to_datetime()</span></code></a> (conversion to datetime objects)</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [328]: </span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="gp">In [329]: </span><span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2016-07-09&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>

<span class="gp">In [330]: </span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="gr">Out[330]: </span><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2016-07-09&#39;</span><span class="p">,</span> <span class="s1">&#39;2016-03-02&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first"><a class="reference internal" href="generated/pandas.to_timedelta.html#pandas.to_timedelta" title="pandas.to_timedelta"><code class="xref py py-meth docutils literal"><span class="pre">to_timedelta()</span></code></a> (conversion to timedelta objects)</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [331]: </span><span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;5us&#39;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s1">&#39;1day&#39;</span><span class="p">)]</span>

<span class="gp">In [332]: </span><span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="gr">Out[332]: </span><span class="n">TimedeltaIndex</span><span class="p">([</span><span class="s1">&#39;0 days 00:00:00.000005&#39;</span><span class="p">,</span> <span class="s1">&#39;1 days 00:00:00&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;timedelta64[ns]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<p>To force a conversion, we can pass in an <code class="docutils literal"><span class="pre">errors</span></code> argument, which specifies how pandas should deal with elements
that cannot be converted to desired dtype or object. By default, <code class="docutils literal"><span class="pre">errors='raise'</span></code>, meaning that any errors encountered
will be raised during the conversion process. However, if <code class="docutils literal"><span class="pre">errors='coerce'</span></code>, these errors will be ignored and pandas
will convert problematic elements to <code class="docutils literal"><span class="pre">pd.NaT</span></code> (for datetime and timedelta) or <code class="docutils literal"><span class="pre">np.nan</span></code> (for numeric). This might be
useful if you are reading in data which is mostly of the desired dtype (e.g. numeric, datetime), but occasionally has
non-conforming elements intermixed that you want to represent as missing:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [333]: </span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="gp">In [334]: </span><span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>

<span class="gp">In [335]: </span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="gr">Out[335]: </span><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;NaT&#39;</span><span class="p">,</span> <span class="s1">&#39;2016-03-02&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

<span class="gp">In [336]: </span><span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="gp">In [337]: </span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="gr">Out[337]: </span><span class="n">array</span><span class="p">([</span> <span class="n">nan</span><span class="p">,</span>   <span class="mf">2.</span><span class="p">,</span>   <span class="mf">3.</span><span class="p">])</span>

<span class="gp">In [338]: </span><span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s1">&#39;1day&#39;</span><span class="p">)]</span>

<span class="gp">In [339]: </span><span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="gr">Out[339]: </span><span class="n">TimedeltaIndex</span><span class="p">([</span><span class="n">NaT</span><span class="p">,</span> <span class="s1">&#39;1 days&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;timedelta64[ns]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">errors</span></code> parameter has a third option of <code class="docutils literal"><span class="pre">errors='ignore'</span></code>, which will simply return the passed in data if it
encounters any errors with the conversion to a desired data type:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [340]: </span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="gp">In [341]: </span><span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>

<span class="gp">In [342]: </span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="gr">Out[342]: </span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>

<span class="gp">In [343]: </span><span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="gp">In [344]: </span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="gr">Out[344]: </span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>

<span class="gp">In [345]: </span><span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s1">&#39;1day&#39;</span><span class="p">)]</span>

<span class="gp">In [346]: </span><span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="gr">Out[346]: </span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="n">Timedelta</span><span class="p">(</span><span class="s1">&#39;1 days 00:00:00&#39;</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></div>
</div>
<p>In addition to object conversion, <a class="reference internal" href="generated/pandas.to_numeric.html#pandas.to_numeric" title="pandas.to_numeric"><code class="xref py py-meth docutils literal"><span class="pre">to_numeric()</span></code></a> provides another argument <code class="docutils literal"><span class="pre">downcast</span></code>, which gives the
option of downcasting the newly (or already) numeric data to a smaller dtype, which can conserve memory:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [347]: </span><span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="gp">In [348]: </span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">downcast</span><span class="o">=</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span>   <span class="c1"># smallest signed int dtype</span>
<span class="gr">Out[348]: </span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int8</span><span class="p">)</span>

<span class="gp">In [349]: </span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">downcast</span><span class="o">=</span><span class="s1">&#39;signed&#39;</span><span class="p">)</span>    <span class="c1"># same as &#39;integer&#39;</span>
<span class="gr">Out[349]: </span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int8</span><span class="p">)</span>

<span class="gp">In [350]: </span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">downcast</span><span class="o">=</span><span class="s1">&#39;unsigned&#39;</span><span class="p">)</span>  <span class="c1"># smallest unsigned int dtype</span>
<span class="gr">Out[350]: </span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">uint8</span><span class="p">)</span>

<span class="gp">In [351]: </span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">downcast</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>     <span class="c1"># smallest float dtype</span>
<span class="gr">Out[351]: </span><span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)</span>
</pre></div>
</div>
<p>As these methods apply only to one-dimensional arrays, lists or scalars; they cannot be used directly on multi-dimensional objects such
as DataFrames. However, with <a class="reference internal" href="generated/pandas.DataFrame.apply.html#pandas.DataFrame.apply" title="pandas.DataFrame.apply"><code class="xref py py-meth docutils literal"><span class="pre">apply()</span></code></a>, we can &#8220;apply&#8221; the function over each column efficiently:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [352]: </span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="gp">In [353]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s1">&#39;2016-07-09&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>

<span class="gp">In [354]: </span><span class="n">df</span>
<span class="gr">Out[354]: </span>
<span class="go">            0                    1</span>
<span class="go">0  2016-07-09  2016-03-02 00:00:00</span>
<span class="go">1  2016-07-09  2016-03-02 00:00:00</span>

<span class="gp">In [355]: </span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">)</span>
<span class="gr">Out[355]: </span>
<span class="go">           0          1</span>
<span class="go">0 2016-07-09 2016-03-02</span>
<span class="go">1 2016-07-09 2016-03-02</span>

<span class="gp">In [356]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s1">&#39;1.1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>

<span class="gp">In [357]: </span><span class="n">df</span>
<span class="gr">Out[357]: </span>
<span class="go">     0  1  2</span>
<span class="go">0  1.1  2  3</span>
<span class="go">1  1.1  2  3</span>

<span class="gp">In [358]: </span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">)</span>
<span class="gr">Out[358]: </span>
<span class="go">     0  1  2</span>
<span class="go">0  1.1  2  3</span>
<span class="go">1  1.1  2  3</span>

<span class="gp">In [359]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s1">&#39;5us&#39;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s1">&#39;1day&#39;</span><span class="p">)]]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>

<span class="gp">In [360]: </span><span class="n">df</span>
<span class="gr">Out[360]: </span>
<span class="go">     0                1</span>
<span class="go">0  5us  1 days 00:00:00</span>
<span class="go">1  5us  1 days 00:00:00</span>

<span class="gp">In [361]: </span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">)</span>
<span class="gr">Out[361]: </span>
<span class="go">                0      1</span>
<span class="go">0 00:00:00.000005 1 days</span>
<span class="go">1 00:00:00.000005 1 days</span>
</pre></div>
</div>
</div>
<div class="section" id="gotchas">
<h3>gotchas<a class="headerlink" href="#gotchas" title="Permalink to this headline">¶</a></h3>
<p>Performing selection operations on <code class="docutils literal"><span class="pre">integer</span></code> type data can easily upcast the data to <code class="docutils literal"><span class="pre">floating</span></code>.
The dtype of the input data will be preserved in cases where <code class="docutils literal"><span class="pre">nans</span></code> are not introduced (starting in 0.11.0)
See also <a class="reference internal" href="gotchas.html#gotchas-intna"><span class="std std-ref">integer na gotchas</span></a></p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [362]: </span><span class="n">dfi</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>

<span class="gp">In [363]: </span><span class="n">dfi</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="gp">In [364]: </span><span class="n">dfi</span>
<span class="gr">Out[364]: </span>
<span class="go">   A  B    C  E</span>
<span class="go">0  0  0    0  1</span>
<span class="go">1  0  0  255  1</span>
<span class="go">2  2  0    1  1</span>
<span class="go">3 -1  0    0  1</span>
<span class="go">4 -1  0    0  1</span>
<span class="go">5  1  0    0  1</span>
<span class="go">6  0  0    0  1</span>
<span class="go">7 -2  1    0  1</span>

<span class="gp">In [365]: </span><span class="n">dfi</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gr">Out[365]: </span>
<span class="go">A    int32</span>
<span class="go">B    int32</span>
<span class="go">C    int32</span>
<span class="go">E    int64</span>
<span class="go">dtype: object</span>

<span class="gp">In [366]: </span><span class="n">casted</span> <span class="o">=</span> <span class="n">dfi</span><span class="p">[</span><span class="n">dfi</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>

<span class="gp">In [367]: </span><span class="n">casted</span>
<span class="gr">Out[367]: </span>
<span class="go">     A    B      C  E</span>
<span class="go">0  NaN  NaN    NaN  1</span>
<span class="go">1  NaN  NaN  255.0  1</span>
<span class="go">2  2.0  NaN    1.0  1</span>
<span class="go">3  NaN  NaN    NaN  1</span>
<span class="go">4  NaN  NaN    NaN  1</span>
<span class="go">5  1.0  NaN    NaN  1</span>
<span class="go">6  NaN  NaN    NaN  1</span>
<span class="go">7  NaN  1.0    NaN  1</span>

<span class="gp">In [368]: </span><span class="n">casted</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gr">Out[368]: </span>
<span class="go">A    float64</span>
<span class="go">B    float64</span>
<span class="go">C    float64</span>
<span class="go">E      int64</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>While float dtypes are unchanged.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [369]: </span><span class="n">dfa</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="gp">In [370]: </span><span class="n">dfa</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfa</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>

<span class="gp">In [371]: </span><span class="n">dfa</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gr">Out[371]: </span>
<span class="go">A    float32</span>
<span class="go">B    float64</span>
<span class="go">C    float64</span>
<span class="go">dtype: object</span>

<span class="gp">In [372]: </span><span class="n">casted</span> <span class="o">=</span> <span class="n">dfa</span><span class="p">[</span><span class="n">df2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>

<span class="gp">In [373]: </span><span class="n">casted</span>
<span class="gr">Out[373]: </span>
<span class="go">          A         B      C</span>
<span class="go">0  0.675238  0.296947    NaN</span>
<span class="go">1       NaN  0.007045  255.0</span>
<span class="go">2  2.025163  0.707877    1.0</span>
<span class="go">3       NaN  0.950661    NaN</span>
<span class="go">4       NaN  0.087527    NaN</span>
<span class="go">5       NaN       NaN    NaN</span>
<span class="go">6  0.385030       NaN    NaN</span>
<span class="go">7 -2.294758  1.775379    NaN</span>

<span class="gp">In [374]: </span><span class="n">casted</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gr">Out[374]: </span>
<span class="go">A    float32</span>
<span class="go">B    float64</span>
<span class="go">C    float64</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="selecting-columns-based-on-dtype">
<h2>Selecting columns based on <code class="docutils literal"><span class="pre">dtype</span></code><a class="headerlink" href="#selecting-columns-based-on-dtype" title="Permalink to this headline">¶</a></h2>
<div class="versionadded" id="basics-selectdtypes">
<p><span class="versionmodified">New in version 0.14.1.</span></p>
</div>
<p>The <a class="reference internal" href="generated/pandas.DataFrame.select_dtypes.html#pandas.DataFrame.select_dtypes" title="pandas.DataFrame.select_dtypes"><code class="xref py py-meth docutils literal"><span class="pre">select_dtypes()</span></code></a> method implements subsetting of columns
based on their <code class="docutils literal"><span class="pre">dtype</span></code>.</p>
<p>First, let&#8217;s create a <a class="reference internal" href="generated/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame"><code class="xref py py-class docutils literal"><span class="pre">DataFrame</span></code></a> with a slew of different
dtypes:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [375]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;string&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">),</span>
<span class="gp">   .....:</span>                    <span class="s1">&#39;int64&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
<span class="gp">   .....:</span>                    <span class="s1">&#39;uint8&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;u1&#39;</span><span class="p">),</span>
<span class="gp">   .....:</span>                    <span class="s1">&#39;float64&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">),</span>
<span class="gp">   .....:</span>                    <span class="s1">&#39;bool1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">],</span>
<span class="gp">   .....:</span>                    <span class="s1">&#39;bool2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">],</span>
<span class="gp">   .....:</span>                    <span class="s1">&#39;dates&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;now&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
<span class="gp">   .....:</span>                    <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s2">&quot;ABC&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)})</span>
<span class="gp">   .....:</span> 

<span class="gp">In [376]: </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tdeltas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dates</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>

<span class="gp">In [377]: </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;uint64&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;u8&#39;</span><span class="p">)</span>

<span class="gp">In [378]: </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;other_dates&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;20130101&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="gp">In [379]: </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tz_aware_dates&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;20130101&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="s1">&#39;US/Eastern&#39;</span><span class="p">)</span>

<span class="gp">In [380]: </span><span class="n">df</span>
<span class="gr">Out[380]: </span>
<span class="go">   bool1  bool2 category                      dates  float64  int64 string  \</span>
<span class="go">0   True  False        A 2016-12-24 18:31:36.297875      4.0      1      a   </span>
<span class="go">1  False   True        B 2016-12-25 18:31:36.297875      5.0      2      b   </span>
<span class="go">2   True  False        C 2016-12-26 18:31:36.297875      6.0      3      c   </span>

<span class="go">   uint8  tdeltas  uint64 other_dates            tz_aware_dates  </span>
<span class="go">0      3      NaT       3  2013-01-01 2013-01-01 00:00:00-05:00  </span>
<span class="go">1      4   1 days       4  2013-01-02 2013-01-02 00:00:00-05:00  </span>
<span class="go">2      5   1 days       5  2013-01-03 2013-01-03 00:00:00-05:00  </span>
</pre></div>
</div>
<p>And the dtypes</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [381]: </span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gr">Out[381]: </span>
<span class="go">bool1                                   bool</span>
<span class="go">bool2                                   bool</span>
<span class="go">category                            category</span>
<span class="go">dates                         datetime64[ns]</span>
<span class="go">float64                              float64</span>
<span class="go">int64                                  int64</span>
<span class="go">string                                object</span>
<span class="go">uint8                                  uint8</span>
<span class="go">tdeltas                      timedelta64[ns]</span>
<span class="go">uint64                                uint64</span>
<span class="go">other_dates                   datetime64[ns]</span>
<span class="go">tz_aware_dates    datetime64[ns, US/Eastern]</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p><a class="reference internal" href="generated/pandas.DataFrame.select_dtypes.html#pandas.DataFrame.select_dtypes" title="pandas.DataFrame.select_dtypes"><code class="xref py py-meth docutils literal"><span class="pre">select_dtypes()</span></code></a> has two parameters <code class="docutils literal"><span class="pre">include</span></code> and <code class="docutils literal"><span class="pre">exclude</span></code> that allow you to
say &#8220;give me the columns WITH these dtypes&#8221; (<code class="docutils literal"><span class="pre">include</span></code>) and/or &#8220;give the
columns WITHOUT these dtypes&#8221; (<code class="docutils literal"><span class="pre">exclude</span></code>).</p>
<p>For example, to select <code class="docutils literal"><span class="pre">bool</span></code> columns</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [382]: </span><span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="nb">bool</span><span class="p">])</span>
<span class="gr">Out[382]: </span>
<span class="go">   bool1  bool2</span>
<span class="go">0   True  False</span>
<span class="go">1  False   True</span>
<span class="go">2   True  False</span>
</pre></div>
</div>
<p>You can also pass the name of a dtype in the <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/arrays.scalars.html">numpy dtype hierarchy</a>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [383]: </span><span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bool&#39;</span><span class="p">])</span>
<span class="gr">Out[383]: </span>
<span class="go">   bool1  bool2</span>
<span class="go">0   True  False</span>
<span class="go">1  False   True</span>
<span class="go">2   True  False</span>
</pre></div>
</div>
<p><a class="reference internal" href="generated/pandas.DataFrame.select_dtypes.html#pandas.DataFrame.select_dtypes" title="pandas.DataFrame.select_dtypes"><code class="xref py py-meth docutils literal"><span class="pre">select_dtypes()</span></code></a> also works with generic dtypes as well.</p>
<p>For example, to select all numeric and boolean columns while excluding unsigned
integers</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [384]: </span><span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="s1">&#39;bool&#39;</span><span class="p">],</span> <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;unsignedinteger&#39;</span><span class="p">])</span>
<span class="gr">Out[384]: </span>
<span class="go">   bool1  bool2  float64  int64  tdeltas</span>
<span class="go">0   True  False      4.0      1      NaT</span>
<span class="go">1  False   True      5.0      2   1 days</span>
<span class="go">2   True  False      6.0      3   1 days</span>
</pre></div>
</div>
<p>To select string columns you must use the <code class="docutils literal"><span class="pre">object</span></code> dtype:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [385]: </span><span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span>
<span class="gr">Out[385]: </span>
<span class="go">  string</span>
<span class="go">0      a</span>
<span class="go">1      b</span>
<span class="go">2      c</span>
</pre></div>
</div>
<p>To see all the child dtypes of a generic <code class="docutils literal"><span class="pre">dtype</span></code> like <code class="docutils literal"><span class="pre">numpy.number</span></code> you
can define a function that returns a tree of child dtypes:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [386]: </span><span class="k">def</span> <span class="nf">subdtypes</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
<span class="gp">   .....:</span>     <span class="n">subs</span> <span class="o">=</span> <span class="n">dtype</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">()</span>
<span class="gp">   .....:</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">subs</span><span class="p">:</span>
<span class="gp">   .....:</span>         <span class="k">return</span> <span class="n">dtype</span>
<span class="gp">   .....:</span>     <span class="k">return</span> <span class="p">[</span><span class="n">dtype</span><span class="p">,</span> <span class="p">[</span><span class="n">subdtypes</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">subs</span><span class="p">]]</span>
<span class="gp">   .....:</span> 
</pre></div>
</div>
<p>All numpy dtypes are subclasses of <code class="docutils literal"><span class="pre">numpy.generic</span></code>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [387]: </span><span class="n">subdtypes</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">generic</span><span class="p">)</span>
<span class="gr">Out[387]: </span>
<span class="go">[numpy.generic,</span>
<span class="go"> [[numpy.number,</span>
<span class="go">   [[numpy.integer,</span>
<span class="go">     [[numpy.signedinteger,</span>
<span class="go">       [numpy.int8,</span>
<span class="go">        numpy.int16,</span>
<span class="go">        numpy.int32,</span>
<span class="go">        numpy.int64,</span>
<span class="go">        numpy.int64,</span>
<span class="go">        numpy.timedelta64]],</span>
<span class="go">      [numpy.unsignedinteger,</span>
<span class="go">       [numpy.uint8,</span>
<span class="go">        numpy.uint16,</span>
<span class="go">        numpy.uint32,</span>
<span class="go">        numpy.uint64,</span>
<span class="go">        numpy.uint64]]]],</span>
<span class="go">    [numpy.inexact,</span>
<span class="go">     [[numpy.floating,</span>
<span class="go">       [numpy.float16, numpy.float32, numpy.float64, numpy.float128]],</span>
<span class="go">      [numpy.complexfloating,</span>
<span class="go">       [numpy.complex64, numpy.complex128, numpy.complex256]]]]]],</span>
<span class="go">  [numpy.flexible,</span>
<span class="go">   [[numpy.character, [numpy.string_, numpy.unicode_]],</span>
<span class="go">    [numpy.void, [numpy.record]]]],</span>
<span class="go">  numpy.bool_,</span>
<span class="go">  numpy.datetime64,</span>
<span class="go">  numpy.object_]]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Pandas also defines the types <code class="docutils literal"><span class="pre">category</span></code>, and <code class="docutils literal"><span class="pre">datetime64[ns,</span> <span class="pre">tz]</span></code>, which are not integrated into the normal
numpy hierarchy and wont show up with the above function.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">include</span></code> and <code class="docutils literal"><span class="pre">exclude</span></code> parameters must be non-string sequences.</p>
</div>
</div>
</div>


                    </div>
                </div>
            </div>

            
            <div class="clearer"></div>
        </div>
    </div>
</div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="text.html" title="Working with Text Data"
             >next</a> |</li>
        <li class="right" >
          <a href="dsintro.html" title="Intro to Data Structures"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pandas 0.19.2 documentation</a> &#187;</li> 
      </ul>
    </div>
<style type="text/css">
    .scrollToTop {
        text-align: center;
        font-weight: bold;
        position: fixed;
        bottom: 60px;
        right: 40px;
        display: none;
    }
</style>
<a href="#" class="scrollToTop">Scroll To Top</a>
<script type="text/javascript">
$(document).ready(function() {
    //Check to see if the window is top if not then display button
    $(window).scroll(function() {
        if ($(this).scrollTop() > 200) {
            $('.scrollToTop').fadeIn();
        } else {
            $('.scrollToTop').fadeOut();
        }
    });

    //Click event to scroll to top
    $('.scrollToTop').click(function() {
        $('html, body').animate({
            scrollTop: 0
        }, 500);
        return false;
    });
});
</script>

  </body>
</html>